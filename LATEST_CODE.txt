--- SNAPSHOT CODE: IDA WIDIAWATI SHOP ---


##########################################################
FILE PATH: app/Controllers/BaseController.php
##########################################################
<?php namespace App\Controllers;

use CodeIgniter\Controller;
use CodeIgniter\HTTP\CLIRequest;
use CodeIgniter\HTTP\IncomingRequest;
use CodeIgniter\HTTP\RequestInterface;
use CodeIgniter\HTTP\ResponseInterface;
use Psr\Log\LoggerInterface;

abstract class BaseController extends Controller {
    protected $request;
    protected $helpers = [];
    protected $appConfig = [];
    protected $L = []; // INI VARIABEL KAMUS KITA

    public function initController(RequestInterface $request, ResponseInterface $response, LoggerInterface $logger) {
        parent::initController($request, $response, $logger);

        $db = \Config\Database::connect();

        // 1. LOAD CONFIG UTAMA
        $query = $db->table('settings')->get()->getResultArray();
        $settings = [];
        foreach($query as $row) { $settings[$row['key']] = $row['value']; }
        
        $this->appConfig = [
            'site_name' => $settings['site_name'] ?? 'IDA WIDIAWATI',
            'site_tagline' => $settings['site_tagline'] ?? 'Kurasi Belanja',
            'site_domain' => $settings['site_domain'] ?? '.shop',
            'badge_list' => explode(',', $settings['badge_list'] ?? 'Pilihan Ibu'),
            'ai_mode' => $settings['ai_mode'] ?? '0'
        ];

        // 2. LOAD LABELS (KAMUS) - PAKE CACHE BIAR NGEBUT
        $cachePath = WRITEPATH . 'cache/site_labels.json';
        if (file_exists($cachePath)) {
            $this->L = json_decode(file_get_contents($cachePath), true);
        } else {
            // Jika cache belum ada, ambil dari DB lalu buat cache
            $qLabels = $db->table('site_labels')->get()->getResultArray();
            $labelMap = [];
            foreach($qLabels as $r) { $labelMap[$r['key']] = $r['value']; }
            $this->L = $labelMap;
            file_put_contents($cachePath, json_encode($labelMap));
        }

        // 3. SEBARKAN KE VIEW
        \Config\Services::renderer()->setData([
            'config' => $this->appConfig,
            'L' => $this->L
        ], 'raw');
    }
}


##########################################################
FILE PATH: app/Controllers/Home.php
##########################################################
<?php 

namespace App\Controllers;

use App\Models\ProductModel;

class Home extends BaseController 
{
    public function index() 
    {
        $request = \Config\Services::request();
        $keyword = $request->getGet('q');
        $sort    = $request->getGet('sort') ?? 'newest';

        // Panggil Model (Gudang Cerdas)
        $productModel = new ProductModel();
        
        // Ambil data (kembaliannya adalah Array of Entities)
        $products = $productModel->getFilteredProducts($keyword, $sort);

        // Optimasi Cache Halaman (Hanya jika tidak sedang mencari/filter)
        if (!$keyword && $sort == 'newest') {
            $this->cachePage(300); 
        }

        return view('product/index', [
            'products' => $products, 
            'keyword'  => $keyword,
            'sort'     => $sort
        ]); 
    }
}

##########################################################
FILE PATH: app/Controllers/Admin.php
##########################################################
<?php namespace App\Controllers;

use App\Libraries\GeminiAgent;

class Admin extends BaseController {
    
        // --- HELPER: IMAGE HANDLER (WEBP CONVERTER + RESIZER) ---
    private function handleImageUpload($fileKey, $urlKey, $oldImage = null) {
        $file = $this->request->getFile($fileKey);
        $url  = $this->request->getPost($urlKey);

        // 1. Prioritas: File Upload Fisik
        if ($file && $file->isValid() && !$file->hasMoved()) {
            
            // A. Garbage Collection (Hapus file lama)
            if ($oldImage && strpos($oldImage, 'uploads/') !== false && file_exists(FCPATH . $oldImage)) {
                unlink(FCPATH . $oldImage);
            }

            // B. Siapkan Nama Baru (WebP)
            $randomName = $file->getRandomName(); // ex: 12345.jpg
            $nameWithoutExt = pathinfo($randomName, PATHINFO_FILENAME);
            $webpName = $nameWithoutExt . '.webp';
            $targetPath = FCPATH . 'uploads/' . $webpName;

            // C. Eksekusi Manipulasi (SMART HIGH FIDELITY)
            try {
                $imageService = \Config\Services::image()->withFile($file);
                // 1. Cek Dimensi Asli
                $origWidth = $imageService->getWidth();
                // 2. LOGIKA ADAPTIF:
                // Hanya resize jika gambar RAKSASA (di atas Full HD / 1920px).
                // Jika gambar sudah pas (misal 1500px), biarkan resolusi aslinya agar pixel sempurna.
                if ($origWidth > 1920) {
                    $imageService->resize(1920, 1920, true, 'width');
                }
                // 3. Simpan sebagai WebP Kualitas Tinggi (95)
                // Angka 95 adalah "Sweet Spot". Mata manusia hampir mustahil bedakan dengan 100,
                // tapi ukuran file turun signifikan karena metadata dibuang.
                $imageService->save($targetPath, 95);
                return 'uploads/' . $webpName;
            } catch (\Exception $e) {
                // Fallback: Jika gagal, simpan file asli tanpa kompresi
                $file->move('uploads', $randomName);
                return 'uploads/' . $randomName;
            }

        }

        // 2. Fallback: URL Eksternal (Link)
        if (!empty($url)) {
            return esc($url);
        }

        // 3. Last Resort
        return $oldImage ?? 'https://placehold.co/600x400/1e293b/FFF?text=NO+IMAGE';
    }


    public function create() { 
        return redirect()->to(route_to('product.detail', $slug))->with('msg', 'Data Diperbarui.');
    }  
    
    // --- STORE: INPUT DATA KETAT ---
    public function store() {
        // 1. ATURAN VALIDASI (THE FIREWALL)
        $rules = [
            'name' => [
                'rules'  => 'required|min_length[3]|max_length[200]|is_unique[products.name]',
                'errors' => [
                    'required' => 'Nama produk wajib diisi.',
                    'is_unique' => 'Produk ini sudah ada di database!',
                ]
            ],
            'market_price' => 'required|numeric|greater_than[0]',
            'image_file'   => [
                'rules' => 'permit_empty|is_image[image_file]|mime_in[image_file,image/jpg,image/jpeg,image/png,image/webp]|max_size[image_file,2048]',
                'errors' => [
                    'mime_in' => 'Format gambar salah (hanya JPG, PNG, WEBP).',
                    'max_size' => 'Ukuran gambar terlalu besar (Maks 2MB).'
                ]
            ]
        ];

        // 2. EKSEKUSI VALIDASI
        if (!$this->validate($rules)) {
            // Kembalikan ke form dengan input sebelumnya + pesan error
            return redirect()->back()->withInput()->with('error', $this->validator->listErrors());
        }

        // 3. PROSES DATA BERSIH
        $db = \Config\Database::connect();
        
        $badgesInput = $this->request->getPost('badges');
        // Pastikan badges selalu Array JSON yang valid
        $badgesJson = empty($badgesInput) ? json_encode(['Pilihan Ibu']) : json_encode(array_slice($badgesInput, 0, 3)); 

        $name = trim($this->request->getPost('name')); // Hapus spasi depan/belakang
        $img  = $this->handleImageUpload('image_file', 'image_url');
        $slug = url_title($name, '-', true); // Buat URL ramah SEO

        // Insert ke DB
        try {
            $db->table('products')->insert([
                'name'         => $name, 
                'slug'         => $slug, 
                'market_price' => $this->request->getPost('market_price'), 
                'image_url'    => $img,
                'badges'       => $badgesJson,
                'description'  => $this->request->getPost('description')
            ]);
            
            return redirect()->to('/index.php/admin/add-link/'.$db->insertID())->with('msg', 'Target Terkunci! Silakan tambah link.');
            
        } catch (\Exception $e) {
            return redirect()->back()->withInput()->with('error', 'Gagal Simpan: ' . $e->getMessage());
        }
    }

    // --- UPDATE: EDIT DATA AMAN ---
    public function update_product() {
        $id = $this->request->getPost('id');
        
        // Aturan Validasi (Nama boleh sama kalau punya diri sendiri)
        $rules = [
            'name' => "required|min_length[3]|max_length[200]|is_unique[products.name,id,{$id}]",
            'market_price' => 'required|numeric',
            'image_file' => 'permit_empty|is_image[image_file]|max_size[image_file,2048]'
        ];

        if (!$this->validate($rules)) {
            return redirect()->back()->withInput()->with('error', $this->validator->listErrors());
        }

        $db = \Config\Database::connect();
        
        $badgesInput = $this->request->getPost('badges');
        $badgesJson = empty($badgesInput) ? json_encode(['Pilihan Ibu']) : json_encode(array_slice($badgesInput, 0, 3));

        // Ambil data lama untuk cek gambar
        $oldData = $db->table('products')->where('id', $id)->get()->getRowArray();
        $img = $this->handleImageUpload('image_file', 'image_url', $oldData['image_url']);
        
        $db->table('products')->where('id', $id)->update([
            'name'         => trim($this->request->getPost('name')),
            'market_price' => $this->request->getPost('market_price'),
            'image_url'    => $img,
            'badges'       => $badgesJson,
            'slug'         => url_title($this->request->getPost('name'), '-', true),
            'description'  => $this->request->getPost('description')
        ]);

        return redirect()->to('/index.php/cek/' . url_title($this->request->getPost('name'), '-', true))->with('msg', 'Data Diperbarui.');
    }

    // --- FUNGSI LAIN (TETAP SAMA TAPI DENGAN PROTEKSI DELETE) ---
    
    public function edit_product($id) { 
        $db = \Config\Database::connect(); 
        $p = $db->table('products')->where('id',$id)->get()->getRowArray(); 
        if(!$p) return redirect()->to('/panel')->with('error', 'Produk tidak ditemukan');
        return view('admin/product/edit', ['p' => $p]);
    }

    public function add_link($pid) { 
        $db = \Config\Database::connect(); 
        $p = $db->table('products')->where('id',$pid)->get()->getRowArray(); 
        if(!$p) return redirect()->to('/panel')->with('error', 'Induk produk hilang');
        return view('admin/link/create', ['p' => $p]);  
    }

    public function store_link() { 
        // Validasi Link sederhana
        if (!$this->validate(['price' => 'required|numeric', 'link' => 'required'])) {
            return redirect()->back()->with('error', 'Harga dan Link wajib diisi.');
        }

        $db=\Config\Database::connect(); 
        $data=[ 
            'product_id' => $this->request->getPost('product_id'), 
            'marketplace'=> $this->request->getPost('marketplace'), 
            'store'      => $this->request->getPost('store'), 
            'price'      => $this->request->getPost('price'), 
            'link'       => $this->request->getPost('link'), 
            'seller_badge'=> $this->request->getPost('seller_badge'), 
            'rating_score'=> $this->request->getPost('rating_score'), 
            'sold_count'  => $this->request->getPost('sold_count') 
        ];
        $db->table('links')->insert($data); 
        return $this->generate_ai($db->insertID()); 
    }

    public function edit_link($id) { 
        $db = \Config\Database::connect(); 
        $l = $db->table('links')->where('id',$id)->get()->getRowArray(); 
        $p = $db->table('products')->where('id',$l['product_id'])->get()->getRowArray(); 
        
        // Mengarah ke folder: app/Views/admin/link/edit.php
        return view('admin/link/edit', ['l' => $l, 'p' => $p]);  
    }

    public function update_link() {
        $db=\Config\Database::connect(); 
        $id=$this->request->getPost('id');
        $data=[ 
            'marketplace'=>$this->request->getPost('marketplace'), 
            'store'=>$this->request->getPost('store'), 
            'price'=>$this->request->getPost('price'), 
            'link'=>$this->request->getPost('link'), 
            'seller_badge'=>$this->request->getPost('seller_badge'), 
            'rating_score'=>$this->request->getPost('rating_score'), 
            'sold_count'=>$this->request->getPost('sold_count'), 
            'ai_comment'=>null // Reset AI kalau data berubah
        ];
        $db->table('links')->where('id',$id)->update($data);
        return $this->generate_ai($id);
    }

    public function generate_ai($linkId) {
        $db=\Config\Database::connect(); 
        $setting=$db->table('settings')->where('key','ai_mode')->get()->getRowArray();
        
        // Bypass jika AI dimatikan
        if(!$setting || $setting['value']=='0'){ 
            $l=$db->table('links')->where('id',$linkId)->get()->getRowArray(); 
            $p=$db->table('products')->where('id',$l['product_id'])->get()->getRowArray(); 
            return redirect()->to('/index.php/cek/'.$p['slug'])->with('msg','Disimpan (AI Standby).'); 
        }

        $data=$db->table('links')->select('links.*, products.name as product_name, products.market_price')->join('products','products.id=links.product_id')->where('links.id',$linkId)->get()->getRowArray();
        
        $agent=new GeminiAgent(); 
        $analisis=$agent->analyzeDeal($data['product_name'],$data['market_price'],$data['price'],$data['store']);
        
        $db->table('links')->where('id',$linkId)->update(['ai_comment'=>$analisis]);
        $p=$db->table('products')->where('id',$data['product_id'])->get()->getRowArray();
        
        return redirect()->to('/index.php/cek/'.$p['slug'])->with('msg','Analisa AI Selesai.');
    }
    
    public function delete_product($id){ 
        $db=\Config\Database::connect(); 
        $p=$db->table('products')->where('id',$id)->get()->getRowArray(); 
        
        // Hapus Gambar Fisik agar server tidak penuh sampah
        if($p['image_url'] && strpos($p['image_url'],'uploads/') !== false){
            if(file_exists($p['image_url'])) unlink($p['image_url']);
        } 
        
        // Hapus links terkait (CASCADE manual jika DB tidak support)
        $db->table('links')->where('product_id', $id)->delete();
        $db->table('products')->where('id',$id)->delete(); 
        
        return redirect()->to('/index.php/panel')->with('msg', 'Target Dieliminasi.'); 
    }

    public function delete_link($id){ 
        $db=\Config\Database::connect(); 
        $l=$db->table('links')->where('id',$id)->get()->getRowArray(); 
        if($l) {
            $pid=$l['product_id']; 
            $db->table('links')->where('id',$id)->delete(); 
            $p=$db->table('products')->where('id',$pid)->get()->getRowArray(); 
            return redirect()->to('/index.php/cek/'.$p['slug']); 
        }
        return redirect()->to('/panel');
    }
}


##########################################################
FILE PATH: app/Controllers/Panel.php
##########################################################
<?php namespace App\Controllers;
class Panel extends BaseController {
    
    public function index() {
        $db = \Config\Database::connect();
        
        // --- FIX: AMBIL CONFIG MANUAL AGAR TIDAK ERROR ---
        $query = $db->table('settings')->get()->getResultArray();
        $config = [];
        foreach($query as $row) { $config[$row['key']] = $row['value']; }
        // Default values jika kosong
        $config = array_merge([
            'site_name' => 'IDA WIDIAWATI',
            'site_tagline' => 'Kurasi Belanja',
            'site_domain' => '.shop',
            'badge_list' => 'Pilihan Ibu,Viral',
            'ai_mode' => '0'
        ], $config);
        $config['badge_list'] = explode(',', $config['badge_list']);
        // -------------------------------------------------

        $totalProducts = $db->table('products')->countAll();
        $totalLinks = $db->table('links')->countAll();
        
        $dbPath = WRITEPATH . '../database.sqlite';
        $dbSize = file_exists($dbPath) ? number_format(filesize($dbPath) / 1024, 2) . ' KB' : '0 KB';

        $links = $db->table('links')->select('links.price, products.market_price')->join('products', 'products.id = links.product_id')->get()->getResultArray();
        $potentialProfit = 0; $undervaluedItems = 0;
        foreach($links as $l) {
            $gap = $l['market_price'] - $l['price'];
            if($gap > 0) { $potentialProfit += $gap; $undervaluedItems++; }
        }

        $sitemapInfo = file_exists(FCPATH . 'sitemap.xml') ? 'Last: ' . date("d M H:i", filemtime(FCPATH . 'sitemap.xml')) : 'Not Found';
        $allProducts = $db->table('products')->orderBy('id', 'DESC')->get()->getResultArray();

        return view('panel_view', [
            'totalProducts' => $totalProducts, 'totalLinks' => $totalLinks,
            'potentialProfit' => $potentialProfit, 'undervaluedCount' => $undervaluedItems,
            'dbSize' => $dbSize, 'phpVersion' => phpversion(),
            'aiMode' => $config['ai_mode'], // Pakai dari config
            'sitemapInfo' => $sitemapInfo,
            'inventory' => $allProducts,
            'config' => $config // LEMPAR CONFIG KE VIEW
        ]);
    }

    public function update_settings() {
        $db = \Config\Database::connect();
        $updates = [
            'site_name' => $this->request->getPost('site_name'),
            'site_domain' => $this->request->getPost('site_domain'),
            'site_tagline' => $this->request->getPost('site_tagline'),
            'badge_list' => $this->request->getPost('badge_list')
        ];
        foreach($updates as $key => $val) {
            if ($db->table('settings')->where('key', $key)->countAllResults() > 0) {
                $db->table('settings')->where('key', $key)->update(['value' => $val]);
            } else {
                $db->table('settings')->insert(['key' => $key, 'value' => $val]);
            }
        }
        return redirect()->to('/index.php/panel')->with('msg', 'Konfigurasi Disimpan!');
    }

    public function toggle_ai() {
        $db = \Config\Database::connect();
        $current = $db->table('settings')->where('key', 'ai_mode')->get()->getRowArray();
        $newVal = ($current && $current['value'] == '1') ? '0' : '1';
        
        if ($db->table('settings')->where('key', 'ai_mode')->countAllResults() > 0) {
            $db->table('settings')->where('key', 'ai_mode')->update(['value' => $newVal]);
        } else {
            $db->table('settings')->insert(['key' => 'ai_mode', 'value' => $newVal]);
        }
        return redirect()->to('/index.php/panel')->with('msg', 'Status AI Berubah.');
    }

    public function change_password() {
        $db = \Config\Database::connect();
        $userId = session()->get('id');
        $oldPass = $this->request->getPost('old_password');
        $newPass = $this->request->getPost('new_password');
        $user = $db->table('users')->where('id', $userId)->get()->getRowArray();

        if (!password_verify($oldPass, $user['password'])) {
            return redirect()->to('/index.php/panel')->with('error', 'Password Lama Salah!');
        }
        $db->table('users')->where('id', $userId)->update(['password' => password_hash($newPass, PASSWORD_DEFAULT)]);
        return redirect()->to('/index.php/panel')->with('msg', 'Password Berhasil Diganti.');
    }

    public function generate_sitemap() {
        try {
            $db = \Config\Database::connect();
            $products = $db->table('products')->select('slug')->get()->getResultArray();
            $xml = '<?xml version="1.0" encoding="UTF-8"?>' . PHP_EOL . '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">' . PHP_EOL;
            // Gunakan base_url($slug) langsung. CI4 akan otomatis menyesuaikan dengan config App.php
            $xml .= '<url><loc>' . base_url($p['slug']) . '</loc><changefreq>weekly</changefreq><priority>0.8</priority></url>' . PHP_EOL;
            foreach ($products as $p) {
                $xml .= '<url><loc>' . base_url('index.php/cek/' . $p['slug']) . '</loc><changefreq>weekly</changefreq><priority>0.8</priority></url>' . PHP_EOL;
            }
            $xml .= '</urlset>';
            if (file_put_contents(FCPATH . 'sitemap.xml', $xml) === false) throw new \Exception("Gagal tulis file.");
            return redirect()->to('/index.php/panel')->with('msg', 'Sitemap Generated!');
        } catch (\Exception $e) {
            return redirect()->to('/index.php/panel')->with('error', $e->getMessage());
        }
    }

    public function nuke_db() {
        $db = \Config\Database::connect();
        $db->table('links')->truncate();
        $db->table('products')->truncate();
        return redirect()->to('/index.php/panel')->with('msg', 'DATABASE DIHAPUS.');
    }
}


##########################################################
FILE PATH: app/Controllers/Auth.php
##########################################################
<?php namespace App\Controllers;

class Auth extends BaseController {
    
    public function login() {
        $session = \Config\Services::session();
        if ($session->has('isLoggedIn') && $session->get('isLoggedIn') === true) {
            return redirect()->to('/index.php');
        }
        return view('login_view');
    }

    public function attempt_login() {
        $session = \Config\Services::session();
        $db = \Config\Database::connect();
        
        $username = $this->request->getPost('username');
        $password = $this->request->getPost('password');
        
        $user = $db->table('users')->where('username', $username)->get()->getRowArray();
        
        if ($user) {
            if (password_verify($password, $user['password'])) {
                $session->set([
                    'id' => $user['id'],
                    'username' => $user['username'],
                    'isLoggedIn' => true
                ]);
                return redirect()->to('/index.php');
            }
        }
        
        return redirect()->back()->with('error', 'Username atau Password Salah.');
    }

    public function logout() {
        $session = \Config\Services::session();
        
        // Bersihkan data session
        $session->remove(['id', 'username', 'isLoggedIn']);
        $session->destroy();
        
        // PERUBAHAN DI SINI: Redirect ke Dashboard Utama (/) bukan Login
        return redirect()->to('/index.php')->withCookies();
    }
}


##########################################################
FILE PATH: app/Controllers/LabelEditor.php
##########################################################
<?php namespace App\Controllers;
class LabelEditor extends BaseController {
    
    public function index() {
        $db = \Config\Database::connect();
        $labels = $db->table('site_labels')->orderBy('group', 'ASC')->get()->getResultArray();
        
        // Kelompokkan data per Tab (Group)
        $grouped = [];
        foreach($labels as $l) { $grouped[$l['group']][] = $l; }

        return view('label_editor_view', ['grouped' => $grouped]);
    }

    public function update() {
        $db = \Config\Database::connect();
        $updates = $this->request->getPost('labels');
        
        if ($updates) {
            foreach($updates as $id => $val) {
                $db->table('site_labels')->where('id', $id)->update(['value' => $val]);
            }
            
            // REFRESH CACHE SETELAH UPDATE
            $all = $db->table('site_labels')->get()->getResultArray();
            $map = [];
            foreach($all as $r) { $map[$r['key']] = $r['value']; }
            file_put_contents(WRITEPATH . 'cache/site_labels.json', json_encode($map));
        }

        return redirect()->to('/index.php/admin/labels')->with('msg', 'Kamus Berhasil Diupdate!');
    }
}


##########################################################
FILE PATH: app/Controllers/Register.php
##########################################################
<?php

namespace App\Controllers;

use App\Controllers\BaseController;
use App\Models\UserModel;

class Register extends BaseController
{
    public function index()
    {
        return view('register_view');
    }

    public function process()
    {
$rules = [
    // Perhatikan penggunaan [ ] di min_length
    'username' => 'required|min_length[4]|is_unique[users.username]',
    'email'    => 'required|valid_email|is_unique[users.email]',
    'password' => 'required|min_length[6]',
    'confpassword' => 'matches[password]'
];

        if (! $this->validate($rules)) {
            return redirect()->back()->withInput()->with('errors', $this->validator->getErrors());
        }

        $userModel = new UserModel();
        $data = [
            'username' => $this->request->getVar('username'),
            'email'    => $this->request->getVar('email'),
            'password' => $this->request->getVar('password'),
        ];

        $userModel->save($data);

        return redirect()->to('/login')->with('success', 'Registrasi Berhasil! Silakan Login.');
    }
}


##########################################################
FILE PATH: app/Controllers/Product.php
##########################################################
<?php 

namespace App\Controllers;

use App\Models\ProductModel;
use App\Models\LinkModel;

class Product extends BaseController 
{
    // Menangani halaman detail produk (domain.com/slug-produk)
    public function index($slug) 
    {
        $db = \Config\Database::connect();
        
        // 1. Ambil Data via Model
        $productModel = new ProductModel();
        $product = $productModel->where('slug', $slug)->first();

        // 2. 404 jika tidak ketemu
        if (!$product) {
            throw \CodeIgniter\Exceptions\PageNotFoundException::forPageNotFound("Produk '$slug' tidak ditemukan.");
        }

        // 3. Ambil Links
        $linkModel = new LinkModel();
        $links = $linkModel->getLinksByProduct($product->id);

        // 4. Cek AI Setting
        $aiSetting = $db->table('settings')->where('key', 'ai_mode')->get()->getRowArray();
        $aiActive = ($aiSetting && $aiSetting['value'] == '1');

        // 5. Panggil View di lokasi baru
        return view('product/detail', [
            'p' => $product, 
            'links' => $links,
            'aiActive' => $aiActive
        ]);
    }
}


##########################################################
FILE PATH: app/Models/UserModel.php
##########################################################
<?php

namespace App\Models;

use CodeIgniter\Model;

class UserModel extends Model
{
    protected $table            = 'users';
    protected $primaryKey       = 'id';
    protected $allowedFields    = ['username', 'email', 'password'];
    protected $useTimestamps    = true;

    // Otomatis Hash Password sebelum simpan
    protected $beforeInsert = ['hashPassword'];
    protected $beforeUpdate = ['hashPassword'];

    protected function hashPassword(array $data)
    {
        if (isset($data['data']['password'])) {
            $data['data']['password'] = password_hash($data['data']['password'], PASSWORD_DEFAULT);
        }
        return $data;
    }
}


##########################################################
FILE PATH: app/Models/ProductModel.php
##########################################################
<?php

namespace App\Models;

use CodeIgniter\Model;
use App\Entities\Product;

class ProductModel extends Model
{
    protected $table            = 'products';
    protected $primaryKey       = 'id';
    protected $useAutoIncrement = true;
    
    // Sambungkan dengan Entity yang baru kita buat
    protected $returnType       = Product::class;
    protected $useSoftDeletes   = false; // Kita belum setup soft delete di migrasi
    
    // Kolom yang boleh diisi (Mass Assignment Protection)
    protected $allowedFields    = [
        'slug', 'name', 'market_price', 
        'image_url', 'badges', 'description'
    ];

    // Validation Rules (Dipindahkan dari Controller Admin)
    protected $validationRules = [
        'name'         => 'required|min_length[3]|max_length[200]',
        // 'slug'      => handled automatically or generated
        'market_price' => 'required|numeric|greater_than[0]',
        // Image validation biasanya tetap di controller karena berhubungan dengan file upload fisik,
        // tapi validasi URL/String-nya bisa di sini.
    ];

    protected $validationMessages = [
        'name' => [
            'required' => 'Nama produk wajib diisi, Bu.',
            'min_length' => 'Nama produk kependekan.',
            'is_unique' => 'Produk ini sudah ada di daftar.'
        ],
        'market_price' => [
            'required' => 'Harga pasaran harus diisi.',
            'numeric' => 'Harga harus berupa angka.',
        ]
    ];

    // Callbacks
    protected $allowCallbacks = true;
    protected $beforeInsert   = ['generateSlug'];
    protected $beforeUpdate   = ['generateSlug'];

    /**
     * Otomatis membuat Slug dari Name sebelum simpan
     */
    protected function generateSlug(array $data)
    {
        if (isset($data['data']['name'])) {
            // Buat slug: "iPhone 15 Pro" -> "iphone-15-pro"
            $slug = url_title($data['data']['name'], '-', true);
            
            // Simpan ke data yang akan diinsert
            $data['data']['slug'] = $slug;
        }
        return $data;
    }
    
    /**
     * Custom Method untuk Pencarian & Filter
     * Menggantikan switch-case di Home.php lama
     */
    public function getFilteredProducts(?string $keyword, string $sort = 'newest')
    {
        $builder = $this; // $this di sini merujuk ke query builder model

        // 1. Filter Pencarian
        if ($keyword) {
            $builder->like('name', $keyword);
        }

        // 2. Filter Sorting
        switch ($sort) {
            case 'price_high':
                $builder->orderBy('market_price', 'DESC');
                break;
            case 'price_low':
                $builder->orderBy('market_price', 'ASC');
                break;
            case 'name_asc':
                $builder->orderBy('name', 'ASC');
                break;
            case 'newest':
            default:
                $builder->orderBy('id', 'DESC');
                break;
        }

        return $builder->findAll(); // Mengembalikan array of Product Entities
    }
}


##########################################################
FILE PATH: app/Models/LinkModel.php
##########################################################
<?php

namespace App\Models;

use CodeIgniter\Model;
use App\Entities\Link;

class LinkModel extends Model
{
    protected $table            = 'links';
    protected $primaryKey       = 'id';
    protected $useAutoIncrement = true;
    protected $returnType       = Link::class; // Return Object Link
    protected $useSoftDeletes   = false;

    protected $allowedFields    = [
        'product_id', 'marketplace', 'store', 'price', 
        'link', 'seller_badge', 'rating_score', 'sold_count', 
        'ai_comment'
    ];

    // Validasi ketat di level Model
    protected $validationRules = [
        'product_id'   => 'required|integer',
        'marketplace'  => 'required',
        'price'        => 'required|numeric',
        'link'         => 'required',
        // Store, badge, rating boleh kosong/default
    ];

    protected $validationMessages = [
        'price' => [
            'required' => 'Harganya berapa, Bu?',
            'numeric'  => 'Harga harus angka ya.'
        ],
        'link' => [
            'required' => 'Link tokonya mana?'
        ]
    ];
    
    /**
     * Mengambil semua link milik produk tertentu, diurutkan termurah
     */
    public function getLinksByProduct(int $productId)
    {
        return $this->where('product_id', $productId)
                    ->orderBy('price', 'ASC')
                    ->findAll();
    }
}


##########################################################
FILE PATH: app/Views/admin/link/create.php
##########################################################
<?= $this->extend('layout/main') ?>

<?= $this->section('title') ?>Tambah Sumber: <?= esc($p['name']) ?><?= $this->endSection() ?>

<?= $this->section('hide_header') ?>true<?= $this->endSection() ?>
<?= $this->section('main_padding') ?>pt-0<?= $this->endSection() ?>

<?= $this->section('content') ?>

    <div class="fixed top-0 left-0 w-full bg-white/90 dark:bg-[#09090b]/90 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 z-50 px-6 py-4 flex justify-between items-center shadow-sm">
        <div>
            <h1 class="text-xs font-black text-slate-500 uppercase tracking-widest">TAMBAH SUMBER</h1>
            <p class="text-sm font-black text-emerald-600 truncate w-48"><?= esc($p['name']) ?></p>
        </div>
        <a href="<?= route_to('product.detail', $p['slug']) ?>" class="text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-3 py-1.5 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition">BATAL</a>
    </div>

    <div class="max-w-md mx-auto px-6 pt-24 pb-40">
        
        <div class="mb-8 relative group">
            <div class="absolute -inset-1 bg-gradient-to-r from-emerald-500 to-blue-500 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-500"></div>
            <div class="relative bg-white dark:bg-slate-900 border-2 border-dashed border-emerald-500/30 rounded-xl p-6 text-center transition-all hover:border-emerald-500">
                <div class="text-3xl mb-2">üìã</div>
                <h3 class="text-sm font-black text-slate-700 dark:text-white uppercase mb-1">Paste Info Marketplace</h3>
                <p class="text-[10px] text-slate-400 mb-4">Salin teks "Share" dari Shopee/Tokped, lalu tempel di sini. Kami akan isi datanya otomatis.</p>
                
                <textarea id="magicPasteArea" class="w-full h-24 bg-slate-50 dark:bg-black border border-slate-200 dark:border-slate-800 rounded-lg p-3 text-xs font-mono focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none transition" placeholder="Tempel teks di sini... (Contoh: Cek barang ini Rp50.000 di Shopee...)"></textarea>
                
                <div id="magicFeedback" class="hidden mt-2 text-[10px] font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 py-1 px-2 rounded-lg inline-block">
                    ‚ú® Berhasil mendeteksi data!
                </div>
            </div>
        </div>

        <form action="<?= route_to('admin.link.store') ?>" method="post" class="space-y-6" id="linkForm">
            <?= csrf_field() ?>
            <input type="hidden" name="product_id" value="<?= $p['id'] ?>">

            <div class="space-y-2">
                <label class="flex justify-between text-[10px] font-bold text-slate-400 uppercase tracking-wider">
                    <span>Link Produk</span>
                    <span id="link-status" class="text-emerald-500 hidden">VALID ‚Ä¢ BERSIH</span>
                </label>
                <div class="relative">
                    <input type="url" name="link" id="linkField" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 pr-12 rounded-2xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none text-xs font-mono transition-all text-slate-600 dark:text-slate-400" placeholder="https://..." required>
                    <div class="absolute right-4 top-4 text-slate-300">üîó</div>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Platform (Auto)</label>
                <div class="grid grid-cols-4 gap-2">
                    <?php 
                    $mps = [
                        'Shopee' => 'peer-checked:bg-[#EE4D2D] peer-checked:text-white peer-checked:border-[#EE4D2D]', 
                        'Tokopedia' => 'peer-checked:bg-[#03AC0E] peer-checked:text-white peer-checked:border-[#03AC0E]', 
                        'Lazada' => 'peer-checked:bg-[#0f146d] peer-checked:text-white peer-checked:border-[#0f146d]', 
                        'TikTok' => 'peer-checked:bg-black peer-checked:text-white peer-checked:border-slate-600'
                    ];
                    foreach($mps as $name => $colorClass): 
                    ?>
                    <label class="cursor-pointer relative group">
                        <input type="radio" name="marketplace" value="<?= $name ?>" class="peer sr-only" id="mp-<?= strtolower($name) ?>">
                        <div class="h-12 flex flex-col items-center justify-center bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl transition-all <?= $colorClass ?> hover:scale-105 shadow-sm active:scale-95">
                            <span class="text-[9px] font-black uppercase tracking-wide"><?= $name ?></span>
                        </div>
                    </label>
                    <?php endforeach; ?>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Harga (Rp)</label>
                    <div class="relative">
                        <input type="tel" name="price_display" id="priceDisplay" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none font-mono font-bold text-lg text-emerald-600" placeholder="0" required inputmode="numeric">
                        <input type="hidden" name="price" id="priceReal">
                    </div>
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Nama Toko</label>
                    <input type="text" name="store" id="storeField" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-emerald-500 outline-none font-bold text-sm" placeholder="Contoh: Official Store">
                </div>
            </div>

            <div class="p-5 bg-slate-50 dark:bg-slate-900/50 rounded-3xl border border-slate-200 dark:border-slate-800 space-y-5">
                
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Badge Toko</label>
                    <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                        <?php foreach(['Toko Biasa','Official Store','Star Seller','Power Merchant'] as $b): ?>
                        <label class="cursor-pointer shrink-0">
                            <input type="radio" name="seller_badge" value="<?= $b ?>" class="peer sr-only" <?= $b=='Toko Biasa'?'checked':'' ?>>
                            <span class="px-3 py-2 rounded-xl text-[10px] font-bold border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-500 peer-checked:bg-slate-900 dark:peer-checked:bg-white peer-checked:text-white dark:peer-checked:text-black peer-checked:border-transparent transition-all shadow-sm"><?= $b ?></span>
                        </label>
                        <?php endforeach; ?>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Rating</label>
                        <select name="rating_score" class="w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 p-3 rounded-xl text-xs font-bold outline-none">
                            <option value="-">-</option>
                            <option value="5.0">‚≠ê 5.0 (Sempurna)</option>
                            <option value="4.9">‚≠ê 4.9 (Sangat Bagus)</option>
                            <option value="4.8">‚≠ê 4.8 (Bagus)</option>
                            <option value="4.7">‚≠ê 4.7 (Oke)</option>
                            <option value="< 4.6">‚≠ê < 4.6 (Kurang)</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Terjual</label>
                        <select name="sold_count" class="w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 p-3 rounded-xl text-xs font-bold outline-none">
                            <option value="-">-</option>
                            <option value="10rb+">üî• 10rb+ (Laris Manis)</option>
                            <option value="5rb+">üî• 5rb+</option>
                            <option value="1rb+">üì¶ 1rb+</option>
                            <option value="500+">üì¶ 500+</option>
                            <option value="100+">üì¶ 100+</option>
                            <option value="< 100">Baru Mulai</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-[#09090b]/90 border-t border-slate-200 dark:border-slate-800 p-4 backdrop-blur-sm z-40">
                 <button type="button" onclick="validateSubmit()" id="btnSave" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-black py-4 rounded-2xl shadow-lg shadow-emerald-500/20 transition-all active:scale-[0.98] text-sm tracking-widest uppercase flex justify-center items-center gap-2">
                    <span>SIMPAN SUMBER</span>
                    <span id="loading-icon" class="hidden animate-spin">‚è≥</span>
                </button>
            </div>

        </form>
    </div>

<?= $this->endSection() ?>

<?= $this->section('scripts') ?>
<script>
    // --- 1. MAGIC PARSER (OTAK UTAMA) ---
    const magicArea = document.getElementById('magicPasteArea');
    const magicFeedback = document.getElementById('magicFeedback');

    // Event Listener untuk Paste di Kotak Ajaib
    magicArea.addEventListener('input', function() {
        const text = this.value;
        if(text.length < 5) return; // Abaikan jika terlalu pendek

        // A. Analisa Link (Cari http/https)
        // Regex: Mencari url, membuang parameter tracking (?...)
        const urlMatch = text.match(/(https?:\/\/[^\s]+)/);
        if (urlMatch) {
            let cleanUrl = urlMatch[0];
            // Bersihkan parameter tracking umum
            if(cleanUrl.includes('?')) cleanUrl = cleanUrl.split('?')[0];
            
            document.getElementById('linkField').value = cleanUrl;
            detectMarketplace(cleanUrl); // Trigger deteksi platform
        }

        // B. Analisa Harga (Cari Rp... atau angka ribuan)
        // Regex: Mencari Rp diikuti angka, titik, atau koma
        const priceMatch = text.match(/Rp\s?([0-9.,]+)/i);
        if (priceMatch) {
            // Bersihkan titik dan koma desimal
            let rawPrice = priceMatch[1].replace(/\./g, '').split(',')[0]; 
            if(rawPrice) {
                formatRupiah(rawPrice); // Masukkan ke input harga
            }
        }

        // C. Feedback Visual
        if (urlMatch || priceMatch) {
            magicFeedback.classList.remove('hidden');
            magicFeedback.innerText = `‚ú® Terdeteksi: ${urlMatch ? 'Link ‚úÖ ' : ''} ${priceMatch ? 'Harga ‚úÖ' : ''}`;
            
            // Efek berkedip pada form yang terisi
            if(urlMatch) highlightField('linkField');
            if(priceMatch) highlightField('priceDisplay');
            
            // Reset kotak ajaib setelah 1 detik agar bersih
            setTimeout(() => {
                magicArea.value = '';
                magicFeedback.classList.add('hidden');
            }, 1500);
        }
    });

    function highlightField(id) {
        const el = document.getElementById(id);
        el.classList.add('ring-2', 'ring-emerald-500');
        setTimeout(() => el.classList.remove('ring-2', 'ring-emerald-500'), 1000);
    }

    // --- 2. LOGIC PLATFORM AUTO-DETECT ---
    const linkInput = document.getElementById('linkField');
    linkInput.addEventListener('input', (e) => detectMarketplace(e.target.value));

    function detectMarketplace(url) {
        url = url.toLowerCase();
        let mp = '';

        if(url.includes('shopee') || url.includes('shp.ee')) mp = 'Shopee';
        else if(url.includes('tokopedia')) mp = 'Tokopedia';
        else if(url.includes('lazada')) mp = 'Lazada';
        else if(url.includes('tiktok') || url.includes('shop')) mp = 'TikTok';

        if(mp) {
            document.getElementById('mp-' + mp.toLowerCase()).checked = true;
            document.getElementById('link-status').classList.remove('hidden');
        }
    }

    // --- 3. FORMAT RUPIAH LIVE ---
    const priceDisplay = document.getElementById('priceDisplay');
    const priceReal = document.getElementById('priceReal');

    priceDisplay.addEventListener('input', function(e) {
        // Hanya ambil angka
        let val = this.value.replace(/[^0-9]/g, '');
        if (!val) {
            this.value = '';
            priceReal.value = '';
            return;
        }
        
        // Simpan nilai asli (integer) ke hidden input
        priceReal.value = val;
        
        // Format tampilan (15.000)
        this.value = new Intl.NumberFormat('id-ID').format(val);
    });

    // Helper untuk set harga dari Magic Paste
    function formatRupiah(val) {
        priceReal.value = val;
        priceDisplay.value = new Intl.NumberFormat('id-ID').format(val);
    }

    // --- 4. VALIDASI AKHIR ---
    function validateSubmit() {
        const link = linkInput.value;
        const price = priceReal.value;
        const btn = document.getElementById('btnSave');
        const icon = document.getElementById('loading-icon');

        if(!link) { alert('Link produk wajib diisi!'); linkInput.focus(); return; }
        if(!price) { alert('Harga wajib diisi!'); priceDisplay.focus(); return; }

        // Pastikan marketplace terpilih
        const mps = document.querySelectorAll('input[name="marketplace"]');
        let checked = false;
        mps.forEach(m => { if(m.checked) checked = true; });
        if(!checked) { 
            // Fallback default
            document.getElementById('mp-shopee').checked = true; 
        }

        // Kunci tombol
        btn.disabled = true;
        btn.classList.add('opacity-75', 'cursor-not-allowed');
        icon.classList.remove('hidden');

        document.getElementById('linkForm').submit();
    }
</script>
<?= $this->endSection() ?>


##########################################################
FILE PATH: app/Views/admin/link/edit.php
##########################################################
<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <title>Edit Link: <?= esc($p['name']) ?></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/app.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script>tailwind.config={darkMode:'class',theme:{extend:{fontFamily:{sans:['Plus Jakarta Sans','sans-serif']}}}}</script>
</head>
<body class="bg-slate-50 dark:bg-[#09090b] text-slate-800 dark:text-slate-200 font-sans min-h-screen pb-32">

    <div class="fixed top-0 left-0 w-full bg-white/80 dark:bg-[#09090b]/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 z-50 px-6 py-4 flex justify-between items-center">
        <div>
            <h1 class="text-xs font-bold text-slate-500 uppercase tracking-widest">EDIT SUMBER</h1>
            <p class="text-sm font-black text-amber-500 truncate w-48"><?= esc($p['name']) ?></p>
        </div>
        <a href="<?= route_to('product.detail', $p['slug']) ?>" class="text-xs font-bold bg-slate-200 dark:bg-slate-800 px-3 py-1.5 rounded-lg">BATAL</a>
    </div>

    <div class="max-w-md mx-auto px-6 pt-24">

        <form action="<?= route_to('admin.link.update') ?>" method="post" class="space-y-6" id="linkForm">
            <?= csrf_field() ?>
            <input type="hidden" name="id" value="<?= $l['id'] ?>">

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Link Affiliate</label>
                <div class="relative">
                    <input type="url" name="link" id="linkField" value="<?= esc($l['link']) ?>" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 pr-20 rounded-2xl focus:border-amber-500 outline-none text-xs font-mono transition-all text-slate-600 dark:text-slate-400" oninput="detectMarketplace()">
                    <button type="button" onclick="pasteLink()" class="absolute right-2 top-2 bottom-2 bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-amber-500 px-4 rounded-xl text-[10px] font-bold transition">GANTI</button>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Platform</label>
                <div class="grid grid-cols-4 gap-2">
                    <?php 
                    $mps = [
                        'Shopee' => 'peer-checked:bg-orange-500 peer-checked:border-orange-500', 
                        'Tokopedia' => 'peer-checked:bg-green-500 peer-checked:border-green-500', 
                        'Lazada' => 'peer-checked:bg-blue-600 peer-checked:border-blue-600', 
                        'TikTok' => 'peer-checked:bg-black peer-checked:border-slate-600 dark:peer-checked:border-slate-500'
                    ];
                    foreach($mps as $name => $colorClass): 
                        $isChecked = ($l['marketplace'] == $name) ? 'checked' : '';
                    ?>
                    <label class="cursor-pointer relative group">
                        <input type="radio" name="marketplace" value="<?= $name ?>" class="peer sr-only" id="mp-<?= strtolower($name) ?>" <?= $isChecked ?>>
                        <div class="h-12 flex items-center justify-center bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl transition-all peer-checked:text-white <?= $colorClass ?> hover:scale-105 shadow-sm">
                            <span class="text-[10px] font-bold"><?= $name ?></span>
                        </div>
                    </label>
                    <?php endforeach; ?>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Harga (Rp)</label>
                    <input type="number" name="price" id="priceField" value="<?= esc($l['price']) ?>" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-amber-500 outline-none font-mono font-bold text-lg text-amber-500" required>
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Nama Toko</label>
                    <input type="text" name="store" value="<?= esc($l['store']) ?>" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-amber-500 outline-none font-bold text-sm">
                </div>
            </div>

            <div class="p-4 bg-slate-100 dark:bg-slate-900/50 rounded-2xl border border-slate-200 dark:border-slate-800 space-y-4">
                
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Badge Toko</label>
                    <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                        <?php foreach(['Toko Biasa','Official Store','Star Seller','Power Merchant'] as $b): 
                            $check = ($l['seller_badge'] == $b) ? 'checked' : '';
                        ?>
                        <label class="cursor-pointer shrink-0">
                            <input type="radio" name="seller_badge" value="<?= $b ?>" class="peer sr-only" <?= $check ?>>
                            <span class="px-3 py-1.5 rounded-lg text-[10px] font-bold border border-slate-300 dark:border-slate-700 text-slate-500 peer-checked:bg-white dark:peer-checked:bg-slate-800 peer-checked:text-amber-600 peer-checked:border-amber-500 transition-all shadow-sm"><?= $b ?></span>
                        </label>
                        <?php endforeach; ?>
                    </div>
                </div>

                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Rating</label>
                    <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                        <?php foreach(['-','5.0','4.9','4.8','4.7','< 4.6'] as $r): 
                             $check = ($l['rating_score'] == $r) ? 'checked' : '';
                        ?>
                        <label class="cursor-pointer shrink-0">
                            <input type="radio" name="rating_score" value="<?= $r ?>" class="peer sr-only" <?= $check ?>>
                            <span class="px-3 py-1.5 rounded-lg text-[10px] font-bold border border-slate-300 dark:border-slate-700 text-slate-500 peer-checked:bg-yellow-500/10 peer-checked:text-yellow-600 peer-checked:border-yellow-500 transition-all shadow-sm">‚òÖ <?= $r ?></span>
                        </label>
                        <?php endforeach; ?>
                    </div>
                </div>

                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-2">Terjual</label>
                    <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                        <?php foreach(['-','10rb+','5rb+','1rb+','500+','100+','< 100'] as $s): 
                             $check = ($l['sold_count'] == $s) ? 'checked' : '';
                        ?>
                        <label class="cursor-pointer shrink-0">
                            <input type="radio" name="sold_count" value="<?= $s ?>" class="peer sr-only" <?= $check ?>>
                            <span class="px-3 py-1.5 rounded-lg text-[10px] font-bold border border-slate-300 dark:border-slate-700 text-slate-500 peer-checked:bg-blue-500/10 peer-checked:text-blue-600 peer-checked:border-blue-500 transition-all shadow-sm">üì¶ <?= $s ?></span>
                        </label>
                        <?php endforeach; ?>
                    </div>
                </div>
            </div>

            <div class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-[#09090b]/90 border-t border-slate-200 dark:border-slate-800 p-4 backdrop-blur-sm z-40 flex flex-col gap-3">
                 <button type="button" onclick="validateSubmit()" class="w-full bg-amber-500 hover:bg-amber-400 text-black font-black py-4 rounded-2xl shadow-lg shadow-amber-500/20 transition-all active:scale-[0.98] text-sm tracking-widest uppercase">
                    SIMPAN PERUBAHAN
                </button>
                
                <a href="<?= route_to('admin.link.delete', $l['id']) ?>" onclick="return confirm('Hapus Link Ini?')" class="text-center text-[10px] font-bold text-red-500 hover:text-red-400 py-2">
                    üóëÔ∏è HAPUS SUMBER INI
                </a>
            </div>

        </form>
        <div class="h-20"></div>
    </div>

    <script>
        function detectMarketplace() {
            const link = document.getElementById('linkField').value.toLowerCase();
            if(link.includes('shopee') || link.includes('shp.ee')) document.getElementById('mp-shopee').checked = true;
            else if(link.includes('tokopedia')) document.getElementById('mp-tokopedia').checked = true;
            else if(link.includes('lazada')) document.getElementById('mp-lazada').checked = true;
            else if(link.includes('tiktok') || link.includes('shop')) document.getElementById('mp-tiktok').checked = true;
        }

        async function pasteLink() {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById('linkField').value = text;
                detectMarketplace();
            } catch (err) {
                alert('Gagal paste.');
            }
        }

        function validateSubmit() {
            const price = document.getElementById('priceField').value;
            const link = document.getElementById('linkField').value;
            
            if(!price || !link) {
                alert('‚ö†Ô∏è Harga dan Link wajib diisi!');
                return;
            }
            document.getElementById('linkForm').submit();
        }

        if(localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
</body>
</html>


##########################################################
FILE PATH: app/Views/admin/product/create.php
##########################################################
<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <title>Input Target Baru</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/app.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script>tailwind.config={darkMode:'class',theme:{extend:{fontFamily:{sans:['Plus Jakarta Sans','sans-serif']}}}}</script>
</head>
<body class="bg-slate-50 dark:bg-[#09090b] text-slate-800 dark:text-slate-200 font-sans min-h-screen pb-24">

    <div class="fixed top-0 left-0 w-full bg-white/80 dark:bg-[#09090b]/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 z-50 px-6 py-4 flex justify-between items-center">
        <h1 class="text-lg font-black text-emerald-600 tracking-tight">INPUT TARGET üéØ</h1>
        <a href="<?= route_to('panel.dashboard') ?>" class="text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 px-3 py-1.5 rounded-lg">BATAL</a>
    </div>

    <div class="max-w-md mx-auto px-6 pt-24">
        
        <?php if(session()->getFlashdata('error')): ?>
            <div class="mb-6 p-4 bg-red-500/10 border border-red-500/50 rounded-2xl flex items-start gap-3">
                <span class="text-xl">‚ö†Ô∏è</span>
                <div>
                    <h4 class="text-xs font-bold text-red-500 uppercase mb-1">Terjadi Kesalahan</h4>
                    <ul class="text-xs text-red-400 list-disc pl-4">
                        <?= session()->getFlashdata('error') ?>
                    </ul>
                </div>
            </div>
        <?php endif; ?>

        <form action="/index.php/admin/store" method="post" enctype="multipart/form-data" class="space-y-6" id="productForm">
            <?= csrf_field() ?>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Nama Produk (Wajib)</label>
                <div class="relative">
                    <input type="text" name="name" id="nameField" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none font-bold text-lg transition-all" placeholder="Contoh: iPhone 15 Pro" required>
                    <button type="button" onclick="pasteTo('nameField')" class="absolute right-3 top-3 bottom-3 bg-slate-100 dark:bg-slate-800 text-slate-500 px-3 rounded-xl text-[10px] font-bold hover:bg-emerald-500 hover:text-white transition">PASTE</button>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Foto Produk</label>
                <div class="bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 rounded-2xl p-2">
                    <div class="flex bg-slate-100 dark:bg-black rounded-xl p-1 mb-3">
                        <button type="button" onclick="switchTab('upload')" id="btn-upload" class="flex-1 py-2 text-xs font-bold rounded-lg bg-white dark:bg-slate-800 shadow text-emerald-600 transition-all">UPLOAD FILE</button>
                        <button type="button" onclick="switchTab('link')" id="btn-link" class="flex-1 py-2 text-xs font-bold rounded-lg text-slate-500 hover:text-emerald-500 transition-all">PAKAI LINK</button>
                    </div>

                    <div class="p-2">
                        <div id="input-upload" class="block text-center">
                            <label class="block w-full border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-6 cursor-pointer hover:border-emerald-500 transition-colors bg-slate-50 dark:bg-slate-900/50">
                                <span class="text-2xl mb-2 block">üìÅ</span>
                                <span class="text-xs font-bold text-slate-500">Ketuk untuk pilih gambar</span>
                                <input type="file" id="file-field" name="image_file" accept="image/*" class="hidden" onchange="previewFile()">
                            </label>
                        </div>

                        <div id="input-link" class="hidden relative">
                            <input type="url" id="url-field" name="image_url" class="w-full bg-slate-50 dark:bg-black border border-slate-300 dark:border-slate-700 p-3 pr-20 rounded-xl outline-none text-xs font-mono text-slate-600 dark:text-slate-400" placeholder="https://..." oninput="previewUrl()">
                            <button type="button" onclick="pasteTo('url-field', true)" class="absolute right-2 top-2 bottom-2 bg-slate-200 dark:bg-slate-800 px-3 rounded-lg text-[10px] font-bold text-slate-500">PASTE</button>
                        </div>
                    </div>

                    <div id="image-preview-container" class="hidden mt-3 relative h-48 bg-slate-100 dark:bg-black rounded-xl overflow-hidden border border-slate-200 dark:border-slate-800">
                        <img id="image-preview" src="" class="w-full h-full object-contain">
                        <button type="button" onclick="resetImage()" class="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition">‚úï</button>
                    </div>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Harga Pasaran (Estimasi)</label>
                <div class="relative">
                    <span class="absolute left-4 top-4 text-slate-400 font-bold">Rp</span>
                    <input type="number" name="market_price" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 pl-12 rounded-2xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none font-mono font-bold text-xl tracking-wider" placeholder="0" required>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Label (Maks 3)</label>
                <div class="grid grid-cols-2 gap-2">
                    <?php 
                    $badgesList = $config['badge_list'] ?? ['Pilihan Ibu', 'Lagi Viral', 'Best Seller', 'Harga Promo', 'Premium', 'Stok Terbatas'];
                    foreach($badgesList as $b): 
                    ?>
                    <label class="cursor-pointer relative group">
                        <input type="checkbox" name="badges[]" value="<?= $b ?>" class="badge-check peer sr-only" onclick="limitChecks(this)">
                        <div class="p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl text-center transition-all peer-checked:border-emerald-500 peer-checked:bg-emerald-500/10 peer-checked:text-emerald-500">
                            <span class="text-[10px] font-bold uppercase"><?= $b ?></span>
                        </div>
                        <div class="absolute top-2 right-2 w-2 h-2 bg-emerald-500 rounded-full hidden peer-checked:block shadow-sm"></div>
                    </label>
                    <?php endforeach; ?>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Catatan Singkat</label>
                <textarea name="description" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none font-medium text-sm min-h-[100px]" placeholder="Tulis spesifikasi penting atau alasan kenapa barang ini bagus..."></textarea>
            </div>

             <div class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-[#09090b]/90 border-t border-slate-200 dark:border-slate-800 p-4 backdrop-blur-sm z-40">
        <button type="button" onclick="validateAndSubmit()" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-emerald-500/20 transition-all active:scale-[0.98] text-sm tracking-widest uppercase flex justify-center items-center gap-2">
            <span>SIMPAN DATA</span>
            <span id="loading-icon" class="hidden animate-spin">‚è≥</span>
        </button>
            </div>


        </form>
    </div>

       <script>
        // --- FITUR BARU: MANUAL VALIDATION ---
        function validateAndSubmit() {
            const nameVal = document.getElementById('nameField').value.trim();
            const priceVal = document.querySelector('input[name="market_price"]').value;
            const btnIcon = document.getElementById('loading-icon');

            // 1. Cek Nama
            if (!nameVal) {
                alert("‚ö†Ô∏è Nama Produk wajib diisi, Bu!");
                document.getElementById('nameField').focus();
                return;
            }

            // 2. Cek Harga
            if (!priceVal) {
                alert("‚ö†Ô∏è Harga Pasar belum diisi!");
                document.querySelector('input[name="market_price"]').focus();
                return;
            }

            // 3. Efek Loading & Submit
            btnIcon.classList.remove('hidden');
            // Hard submit: memaksa form dengan ID 'productForm' untuk dikirim
            document.getElementById('productForm').submit();
        }

        // --- LOGIC LAMA (TETAP DIPERTAHANKAN) ---

        // 1. Logic Tab Switcher
        function switchTab(mode) {
            const uploadDiv = document.getElementById('input-upload');
            const linkDiv = document.getElementById('input-link');
            const btnUpload = document.getElementById('btn-upload');
            const btnLink = document.getElementById('btn-link');

            if(mode === 'upload') {
                uploadDiv.classList.remove('hidden');
                linkDiv.classList.add('hidden');
                btnUpload.classList.add('bg-white', 'dark:bg-slate-800', 'shadow', 'text-emerald-600');
                btnLink.classList.remove('bg-white', 'dark:bg-slate-800', 'shadow', 'text-emerald-600');
                document.getElementById('url-field').value = '';
            } else {
                linkDiv.classList.remove('hidden');
                uploadDiv.classList.add('hidden');
                btnLink.classList.add('bg-white', 'dark:bg-slate-800', 'shadow', 'text-emerald-600');
                btnUpload.classList.remove('bg-white', 'dark:bg-slate-800', 'shadow', 'text-emerald-600');
                document.getElementById('file-field').value = '';
            }
        }

        // 2. Logic Image Preview
        const previewContainer = document.getElementById('image-preview-container');
        const previewImg = document.getElementById('image-preview');

        function showPreview(src) {
            previewImg.src = src;
            previewContainer.classList.remove('hidden');
        }

        function resetImage() {
            previewImg.src = '';
            previewContainer.classList.add('hidden');
            document.getElementById('file-field').value = '';
            document.getElementById('url-field').value = '';
        }

        function previewFile() {
            const file = document.getElementById('file-field').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    showPreview(e.target.result);
                };
                reader.readAsDataURL(file);
            }
        }

        function previewUrl() {
            const url = document.getElementById('url-field').value;
            if(url.length > 10) showPreview(url);
        }

        // 3. Logic Paste
        async function pasteTo(elementId, triggerPreview = false) {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById(elementId).value = text;
                if(triggerPreview) previewUrl();
            } catch (err) {
                alert('Gagal paste. Izin clipboard ditolak atau tidak support di browser ini.');
            }
        }

        // 4. Logic Limit Checkbox
        function limitChecks(checkbox) {
            const checks = document.querySelectorAll('.badge-check');
            let count = 0;
            checks.forEach(c => { if(c.checked) count++; });
            if (count > 3) {
                checkbox.checked = false;
                alert('Maksimal 3 label saja ya, Bu!'); 
            }
        }

        // Auto Dark Mode
        if(localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>

</body>
</html>


##########################################################
FILE PATH: app/Views/admin/product/edit.php
##########################################################
<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <title>Edit Target: <?= esc($p['name']) ?></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/app.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script>tailwind.config={darkMode:'class',theme:{extend:{fontFamily:{sans:['Plus Jakarta Sans','sans-serif']}}}}</script>
</head>
<body class="bg-slate-50 dark:bg-[#09090b] text-slate-800 dark:text-slate-200 font-sans min-h-screen pb-32">

    <div class="fixed top-0 left-0 w-full bg-white/80 dark:bg-[#09090b]/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 z-50 px-6 py-4 flex justify-between items-center">
        <h1 class="text-lg font-black text-amber-500 tracking-tight">EDIT TARGET ‚úèÔ∏è</h1>
        <a href="<?= route_to('product.detail', $p['slug']) ?>" class="text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 px-3 py-1.5 rounded-lg">BATAL</a>
    </div>

    <div class="max-w-md mx-auto px-6 pt-24">
        
        <?php if(session()->getFlashdata('error')): ?>
            <div class="mb-6 p-4 bg-red-500/10 border border-red-500/50 rounded-2xl flex items-start gap-3">
                <span class="text-xl">‚ö†Ô∏è</span>
                <div>
                    <h4 class="text-xs font-bold text-red-500 uppercase mb-1">Gagal Update</h4>
                    <ul class="text-xs text-red-400 list-disc pl-4">
                        <?= session()->getFlashdata('error') ?>
                    </ul>
                </div>
            </div>
        <?php endif; ?>

        <form action="<?= route_to('admin.product.update') ?>" method="post" enctype="multipart/form-data" class="space-y-6" id="editForm">
            <?= csrf_field() ?>
            <input type="hidden" name="id" value="<?= $p['id'] ?>">

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Nama Produk</label>
                <div class="relative">
                    <input type="text" name="name" id="nameField" value="<?= esc($p['name']) ?>" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 outline-none font-bold text-lg transition-all" required>
                    <button type="button" onclick="pasteTo('nameField')" class="absolute right-3 top-3 bottom-3 bg-slate-100 dark:bg-slate-800 text-slate-500 px-3 rounded-xl text-[10px] font-bold hover:bg-amber-500 hover:text-white transition">PASTE</button>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Foto Produk</label>
                <div class="bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 rounded-2xl p-2">
                    
                    <div class="flex bg-slate-100 dark:bg-black rounded-xl p-1 mb-3">
                        <button type="button" onclick="switchTab('upload')" id="btn-upload" class="flex-1 py-2 text-xs font-bold rounded-lg bg-white dark:bg-slate-800 shadow text-amber-600 transition-all">UPLOAD BARU</button>
                        <button type="button" onclick="switchTab('link')" id="btn-link" class="flex-1 py-2 text-xs font-bold rounded-lg text-slate-500 hover:text-amber-500 transition-all">LINK BARU</button>
                    </div>

                    <div class="p-2">
                        <div id="input-upload" class="block text-center">
                            <label class="block w-full border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-6 cursor-pointer hover:border-amber-500 transition-colors bg-slate-50 dark:bg-slate-900/50">
                                <span class="text-2xl mb-2 block">üì∑</span>
                                <span class="text-xs font-bold text-slate-500">Ketuk untuk ganti gambar</span>
                                <input type="file" id="file-field" name="image_file" accept="image/*" class="hidden" onchange="previewFile()">
                            </label>
                        </div>

                        <div id="input-link" class="hidden relative">
                            <input type="url" id="url-field" name="image_url" class="w-full bg-slate-50 dark:bg-black border border-slate-300 dark:border-slate-700 p-3 pr-20 rounded-xl outline-none text-xs font-mono text-slate-600 dark:text-slate-400" placeholder="https://..." oninput="previewUrl()">
                            <button type="button" onclick="pasteTo('url-field', true)" class="absolute right-2 top-2 bottom-2 bg-slate-200 dark:bg-slate-800 px-3 rounded-lg text-[10px] font-bold text-slate-500">PASTE</button>
                        </div>
                    </div>

                    <div id="image-preview-container" class="mt-3 relative h-48 bg-slate-100 dark:bg-black rounded-xl overflow-hidden border border-slate-200 dark:border-slate-800 group">
                        <img id="image-preview" src="<?= (strpos($p['image_url'],'http')===0) ? $p['image_url'] : '/'.$p['image_url'] ?>" class="w-full h-full object-contain">
                        <div class="absolute bottom-0 left-0 w-full bg-black/50 p-2 text-center text-[10px] text-white font-bold backdrop-blur-sm">
                            GAMBAR SAAT INI / PREVIEW
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Harga Pasaran</label>
                <div class="relative">
                    <span class="absolute left-4 top-4 text-slate-400 font-bold">Rp</span>
                    <input type="number" name="market_price" value="<?= esc($p['market_price']) ?>" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 pl-12 rounded-2xl focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 outline-none font-mono font-bold text-xl tracking-wider" required>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Label (Maks 3)</label>
                <div class="grid grid-cols-2 gap-2">
                    <?php 
                    $currentBadges = json_decode($p['badges'] ?? '[]', true);
                    if(!is_array($currentBadges)) $currentBadges = [];
                    
                    $badgesList = $config['badge_list'] ?? ['Pilihan Ibu', 'Lagi Viral', 'Best Seller', 'Harga Promo', 'Premium', 'Stok Terbatas'];
                    
                    foreach($badgesList as $b): 
                        $isChecked = in_array($b, $currentBadges) ? 'checked' : '';
                    ?>
                    <label class="cursor-pointer relative group">
                        <input type="checkbox" name="badges[]" value="<?= $b ?>" class="badge-check peer sr-only" onclick="limitChecks(this)" <?= $isChecked ?>>
                        <div class="p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl text-center transition-all peer-checked:border-amber-500 peer-checked:bg-amber-500/10 peer-checked:text-amber-500">
                            <span class="text-[10px] font-bold uppercase"><?= $b ?></span>
                        </div>
                        <div class="absolute top-2 right-2 w-2 h-2 bg-amber-500 rounded-full hidden peer-checked:block shadow-sm"></div>
                    </label>
                    <?php endforeach; ?>
                </div>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Catatan Singkat</label>
                <textarea name="description" class="w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 p-4 rounded-2xl focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20 outline-none font-medium text-sm min-h-[120px]"><?= esc($p['description']) ?></textarea>
            </div>
            
            <div class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-[#09090b]/90 border-t border-slate-200 dark:border-slate-800 p-4 backdrop-blur-sm z-40 flex gap-3">
                 <button type="button" onclick="validateAndSubmit()" class="flex-1 bg-amber-500 hover:bg-amber-400 text-black font-black py-4 rounded-2xl shadow-lg shadow-amber-500/20 transition-all active:scale-[0.98] text-sm tracking-widest uppercase flex justify-center items-center gap-2">
                    <span>SIMPAN PERUBAHAN</span>
                    <span id="loading-icon" class="hidden animate-spin">‚è≥</span>
                </button>
            </div>

        </form>

        <div class="mt-12 mb-12 p-6 border border-red-500/20 rounded-3xl bg-red-500/5 text-center">
            <h3 class="text-xs font-bold text-red-500 uppercase mb-2">Danger Zone</h3>
            <p class="text-[10px] text-red-400 mb-4">Menghapus produk ini akan menghapus semua link afiliasi di dalamnya secara permanen.</p>
            <a href="<?= route_to('admin.product.delete') ?>" onclick="return confirm('YAKIN HAPUS? Data tidak bisa dikembalikan!')" class="inline-block px-6 py-3 bg-red-500 hover:bg-red-600 text-white text-[10px] font-bold rounded-xl shadow-lg shadow-red-500/20 transition">
                üóëÔ∏è HAPUS TARGET INI
            </a>
        </div>

    </div>

    <script>
        function validateAndSubmit() {
            const nameVal = document.getElementById('nameField').value.trim();
            const priceVal = document.querySelector('input[name="market_price"]').value;
            const btnIcon = document.getElementById('loading-icon');

            if (!nameVal) {
                alert("‚ö†Ô∏è Nama Produk tidak boleh kosong!");
                document.getElementById('nameField').focus();
                return;
            }
            if (!priceVal) {
                alert("‚ö†Ô∏è Harga Pasar tidak boleh kosong!");
                return;
            }

            btnIcon.classList.remove('hidden');
            document.getElementById('editForm').submit();
        }

        function switchTab(mode) {
            const uploadDiv = document.getElementById('input-upload');
            const linkDiv = document.getElementById('input-link');
            const btnUpload = document.getElementById('btn-upload');
            const btnLink = document.getElementById('btn-link');

            if(mode === 'upload') {
                uploadDiv.classList.remove('hidden');
                linkDiv.classList.add('hidden');
                btnUpload.classList.add('bg-white', 'dark:bg-slate-800', 'shadow', 'text-amber-600');
                btnLink.classList.remove('bg-white', 'dark:bg-slate-800', 'shadow', 'text-amber-600');
                document.getElementById('url-field').value = '';
            } else {
                linkDiv.classList.remove('hidden');
                uploadDiv.classList.add('hidden');
                btnLink.classList.add('bg-white', 'dark:bg-slate-800', 'shadow', 'text-amber-600');
                btnUpload.classList.remove('bg-white', 'dark:bg-slate-800', 'shadow', 'text-amber-600');
                document.getElementById('file-field').value = '';
            }
        }

        const previewImg = document.getElementById('image-preview');

        function showPreview(src) {
            previewImg.src = src;
        }

        function previewFile() {
            const file = document.getElementById('file-field').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    showPreview(e.target.result);
                };
                reader.readAsDataURL(file);
            }
        }

        function previewUrl() {
            const url = document.getElementById('url-field').value;
            if(url.length > 10) showPreview(url);
        }

        async function pasteTo(elementId, triggerPreview = false) {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById(elementId).value = text;
                if(triggerPreview) previewUrl();
            } catch (err) {
                alert('Gagal paste.');
            }
        }

        function limitChecks(checkbox) {
            const checks = document.querySelectorAll('.badge-check');
            let count = 0;
            checks.forEach(c => { if(c.checked) count++; });
            if (count > 3) {
                checkbox.checked = false;
                alert('Maksimal 3 label!'); 
            }
        }

        if(localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
</body>
</html>


##########################################################
FILE PATH: app/Config/App.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class App extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Base Site URL
     * --------------------------------------------------------------------------
     *
     * URL to your CodeIgniter root. Typically, this will be your base URL,
     * WITH a trailing slash:
     *
     * E.g., http://example.com/
     */
    public string $baseURL = 'http://localhost:8080/';
    
    public bool $compressOutput = true; // Ubah false jadi true

    /**
     * Allowed Hostnames in the Site URL other than the hostname in the baseURL.
     * If you want to accept multiple Hostnames, set this.
     *
     * E.g.,
     * When your site URL ($baseURL) is 'http://example.com/', and your site
     * also accepts 'http://media.example.com/' and 'http://accounts.example.com/':
     *     ['media.example.com', 'accounts.example.com']
     *
     * @var list<string>
     */
    public array $allowedHostnames = [];

    /**
     * --------------------------------------------------------------------------
     * Index File
     * --------------------------------------------------------------------------
     *
     * Typically, this will be your `index.php` file, unless you've renamed it to
     * something else. If you have configured your web server to remove this file
     * from your site URIs, set this variable to an empty string.
     */
    public string $indexPage = '';

    /**
     * --------------------------------------------------------------------------
     * URI PROTOCOL
     * --------------------------------------------------------------------------
     *
     * This item determines which server global should be used to retrieve the
     * URI string. The default setting of 'REQUEST_URI' works for most servers.
     * If your links do not seem to work, try one of the other delicious flavors:
     *
     *  'REQUEST_URI': Uses $_SERVER['REQUEST_URI']
     * 'QUERY_STRING': Uses $_SERVER['QUERY_STRING']
     *    'PATH_INFO': Uses $_SERVER['PATH_INFO']
     *
     * WARNING: If you set this to 'PATH_INFO', URIs will always be URL-decoded!
     */
    public string $uriProtocol = 'REQUEST_URI';

    /*
    |--------------------------------------------------------------------------
    | Allowed URL Characters
    |--------------------------------------------------------------------------
    |
    | This lets you specify which characters are permitted within your URLs.
    | When someone tries to submit a URL with disallowed characters they will
    | get a warning message.
    |
    | As a security measure you are STRONGLY encouraged to restrict URLs to
    | as few characters as possible.
    |
    | By default, only these are allowed: `a-z 0-9~%.:_-`
    |
    | Set an empty string to allow all characters -- but only if you are insane.
    |
    | The configured value is actually a regular expression character group
    | and it will be used as: '/\A[<permittedURIChars>]+\z/iu'
    |
    | DO NOT CHANGE THIS UNLESS YOU FULLY UNDERSTAND THE REPERCUSSIONS!!
    |
    */
    public string $permittedURIChars = 'a-z 0-9~%.:_\-';

    /**
     * --------------------------------------------------------------------------
     * Default Locale
     * --------------------------------------------------------------------------
     *
     * The Locale roughly represents the language and location that your visitor
     * is viewing the site from. It affects the language strings and other
     * strings (like currency markers, numbers, etc), that your program
     * should run under for this request.
     */
    public string $defaultLocale = 'en';

    /**
     * --------------------------------------------------------------------------
     * Negotiate Locale
     * --------------------------------------------------------------------------
     *
     * If true, the current Request object will automatically determine the
     * language to use based on the value of the Accept-Language header.
     *
     * If false, no automatic detection will be performed.
     */
    public bool $negotiateLocale = false;

    /**
     * --------------------------------------------------------------------------
     * Supported Locales
     * --------------------------------------------------------------------------
     *
     * If $negotiateLocale is true, this array lists the locales supported
     * by the application in descending order of priority. If no match is
     * found, the first locale will be used.
     *
     * IncomingRequest::setLocale() also uses this list.
     *
     * @var list<string>
     */
    public array $supportedLocales = ['en'];

    /**
     * --------------------------------------------------------------------------
     * Application Timezone
     * --------------------------------------------------------------------------
     *
     * The default timezone that will be used in your application to display
     * dates with the date helper, and can be retrieved through app_timezone()
     *
     * @see https://www.php.net/manual/en/timezones.php for list of timezones
     *      supported by PHP.
     */
    public string $appTimezone = 'UTC';

    /**
     * --------------------------------------------------------------------------
     * Default Character Set
     * --------------------------------------------------------------------------
     *
     * This determines which character set is used by default in various methods
     * that require a character set to be provided.
     *
     * @see http://php.net/htmlspecialchars for a list of supported charsets.
     */
    public string $charset = 'UTF-8';

    /**
     * --------------------------------------------------------------------------
     * Force Global Secure Requests
     * --------------------------------------------------------------------------
     *
     * If true, this will force every request made to this application to be
     * made via a secure connection (HTTPS). If the incoming request is not
     * secure, the user will be redirected to a secure version of the page
     * and the HTTP Strict Transport Security (HSTS) header will be set.
     */
    public bool $forceGlobalSecureRequests = false;

    /**
     * --------------------------------------------------------------------------
     * Reverse Proxy IPs
     * --------------------------------------------------------------------------
     *
     * If your server is behind a reverse proxy, you must whitelist the proxy
     * IP addresses from which CodeIgniter should trust headers such as
     * X-Forwarded-For or Client-IP in order to properly identify
     * the visitor's IP address.
     *
     * You need to set a proxy IP address or IP address with subnets and
     * the HTTP header for the client IP address.
     *
     * Here are some examples:
     *     [
     *         '10.0.1.200'     => 'X-Forwarded-For',
     *         '192.168.5.0/24' => 'X-Real-IP',
     *     ]
     *
     * @var array<string, string>
     */
    public array $proxyIPs = [];

    /**
     * --------------------------------------------------------------------------
     * Content Security Policy
     * --------------------------------------------------------------------------
     *
     * Enables the Response's Content Secure Policy to restrict the sources that
     * can be used for images, scripts, CSS files, audio, video, etc. If enabled,
     * the Response object will populate default values for the policy from the
     * `ContentSecurityPolicy.php` file. Controllers can always add to those
     * restrictions at run time.
     *
     * For a better understanding of CSP, see these documents:
     *
     * @see http://www.html5rocks.com/en/tutorials/security/content-security-policy/
     * @see http://www.w3.org/TR/CSP/
     */
    public bool $CSPEnabled = false;
}


##########################################################
FILE PATH: app/Config/Autoload.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\AutoloadConfig;

/**
 * -------------------------------------------------------------------
 * AUTOLOADER CONFIGURATION
 * -------------------------------------------------------------------
 *
 * This file defines the namespaces and class maps so the Autoloader
 * can find the files as needed.
 *
 * NOTE: If you use an identical key in $psr4 or $classmap, then
 *       the values in this file will overwrite the framework's values.
 *
 * NOTE: This class is required prior to Autoloader instantiation,
 *       and does not extend BaseConfig.
 */
class Autoload extends AutoloadConfig
{
    /**
     * -------------------------------------------------------------------
     * Namespaces
     * -------------------------------------------------------------------
     * This maps the locations of any namespaces in your application to
     * their location on the file system. These are used by the autoloader
     * to locate files the first time they have been instantiated.
     *
     * The 'Config' (APPPATH . 'Config') and 'CodeIgniter' (SYSTEMPATH) are
     * already mapped for you.
     *
     * You may change the name of the 'App' namespace if you wish,
     * but this should be done prior to creating any namespaced classes,
     * else you will need to modify all of those classes for this to work.
     *
     * @var array<string, list<string>|string>
     */
    public $psr4 = [
        APP_NAMESPACE => APPPATH,
    ];

    /**
     * -------------------------------------------------------------------
     * Class Map
     * -------------------------------------------------------------------
     * The class map provides a map of class names and their exact
     * location on the drive. Classes loaded in this manner will have
     * slightly faster performance because they will not have to be
     * searched for within one or more directories as they would if they
     * were being autoloaded through a namespace.
     *
     * Prototype:
     *   $classmap = [
     *       'MyClass'   => '/path/to/class/file.php'
     *   ];
     *
     * @var array<string, string>
     */
    public $classmap = [];

    /**
     * -------------------------------------------------------------------
     * Files
     * -------------------------------------------------------------------
     * The files array provides a list of paths to __non-class__ files
     * that will be autoloaded. This can be useful for bootstrap operations
     * or for loading functions.
     *
     * Prototype:
     *   $files = [
     *       '/path/to/my/file.php',
     *   ];
     *
     * @var list<string>
     */
    public $files = [];

    /**
     * -------------------------------------------------------------------
     * Helpers
     * -------------------------------------------------------------------
     * Prototype:
     *   $helpers = [
     *       'form',
     *   ];
     *
     * @var list<string>
     */
    public $helpers = [];
}


##########################################################
FILE PATH: app/Config/Boot/development.php
##########################################################
<?php

/*
 |--------------------------------------------------------------------------
 | ERROR DISPLAY
 |--------------------------------------------------------------------------
 | In development, we want to show as many errors as possible to help
 | make sure they don't make it to production. And save us hours of
 | painful debugging.
 |
 | If you set 'display_errors' to '1', CI4's detailed error report will show.
 */
error_reporting(E_ALL);
ini_set('display_errors', '1');

/*
 |--------------------------------------------------------------------------
 | DEBUG BACKTRACES
 |--------------------------------------------------------------------------
 | If true, this constant will tell the error screens to display debug
 | backtraces along with the other error information. If you would
 | prefer to not see this, set this value to false.
 */
defined('SHOW_DEBUG_BACKTRACE') || define('SHOW_DEBUG_BACKTRACE', true);

/*
 |--------------------------------------------------------------------------
 | DEBUG MODE
 |--------------------------------------------------------------------------
 | Debug mode is an experimental flag that can allow changes throughout
 | the system. This will control whether Kint is loaded, and a few other
 | items. It can always be used within your own application too.
 */
defined('CI_DEBUG') || define('CI_DEBUG', true);


##########################################################
FILE PATH: app/Config/Boot/production.php
##########################################################
<?php

/*
 |--------------------------------------------------------------------------
 | ERROR DISPLAY
 |--------------------------------------------------------------------------
 | Don't show ANY in production environments. Instead, let the system catch
 | it and display a generic error message.
 |
 | If you set 'display_errors' to '1', CI4's detailed error report will show.
 */
error_reporting(E_ALL & ~E_DEPRECATED);
// If you want to suppress more types of errors.
// error_reporting(E_ALL & ~E_NOTICE & ~E_DEPRECATED & ~E_STRICT & ~E_USER_NOTICE & ~E_USER_DEPRECATED);
ini_set('display_errors', '0');

/*
 |--------------------------------------------------------------------------
 | DEBUG MODE
 |--------------------------------------------------------------------------
 | Debug mode is an experimental flag that can allow changes throughout
 | the system. It's not widely used currently, and may not survive
 | release of the framework.
 */
defined('CI_DEBUG') || define('CI_DEBUG', false);


##########################################################
FILE PATH: app/Config/Boot/testing.php
##########################################################
<?php

/*
 * The environment testing is reserved for PHPUnit testing. It has special
 * conditions built into the framework at various places to assist with that.
 * You can‚Äôt use it for your development.
 */

/*
 |--------------------------------------------------------------------------
 | ERROR DISPLAY
 |--------------------------------------------------------------------------
 | In development, we want to show as many errors as possible to help
 | make sure they don't make it to production. And save us hours of
 | painful debugging.
 */
error_reporting(E_ALL);
ini_set('display_errors', '1');

/*
 |--------------------------------------------------------------------------
 | DEBUG BACKTRACES
 |--------------------------------------------------------------------------
 | If true, this constant will tell the error screens to display debug
 | backtraces along with the other error information. If you would
 | prefer to not see this, set this value to false.
 */
defined('SHOW_DEBUG_BACKTRACE') || define('SHOW_DEBUG_BACKTRACE', true);

/*
 |--------------------------------------------------------------------------
 | DEBUG MODE
 |--------------------------------------------------------------------------
 | Debug mode is an experimental flag that can allow changes throughout
 | the system. It's not widely used currently, and may not survive
 | release of the framework.
 */
defined('CI_DEBUG') || define('CI_DEBUG', true);


##########################################################
FILE PATH: app/Config/CURLRequest.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class CURLRequest extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * CURLRequest Share Options
     * --------------------------------------------------------------------------
     *
     * Whether share options between requests or not.
     *
     * If true, all the options won't be reset between requests.
     * It may cause an error request with unnecessary headers.
     */
    public bool $shareOptions = false;
}


##########################################################
FILE PATH: app/Config/Cache.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Cache\CacheInterface;
use CodeIgniter\Cache\Handlers\DummyHandler;
use CodeIgniter\Cache\Handlers\FileHandler;
use CodeIgniter\Cache\Handlers\MemcachedHandler;
use CodeIgniter\Cache\Handlers\PredisHandler;
use CodeIgniter\Cache\Handlers\RedisHandler;
use CodeIgniter\Cache\Handlers\WincacheHandler;
use CodeIgniter\Config\BaseConfig;

class Cache extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Primary Handler
     * --------------------------------------------------------------------------
     *
     * The name of the preferred handler that should be used. If for some reason
     * it is not available, the $backupHandler will be used in its place.
     */
    public string $handler = 'file';

    /**
     * --------------------------------------------------------------------------
     * Backup Handler
     * --------------------------------------------------------------------------
     *
     * The name of the handler that will be used in case the first one is
     * unreachable. Often, 'file' is used here since the filesystem is
     * always available, though that's not always practical for the app.
     */
    public string $backupHandler = 'dummy';

    /**
     * --------------------------------------------------------------------------
     * Key Prefix
     * --------------------------------------------------------------------------
     *
     * This string is added to all cache item names to help avoid collisions
     * if you run multiple applications with the same cache engine.
     */
    public string $prefix = '';

    /**
     * --------------------------------------------------------------------------
     * Default TTL
     * --------------------------------------------------------------------------
     *
     * The default number of seconds to save items when none is specified.
     *
     * WARNING: This is not used by framework handlers where 60 seconds is
     * hard-coded, but may be useful to projects and modules. This will replace
     * the hard-coded value in a future release.
     */
    public int $ttl = 60;

    /**
     * --------------------------------------------------------------------------
     * Reserved Characters
     * --------------------------------------------------------------------------
     *
     * A string of reserved characters that will not be allowed in keys or tags.
     * Strings that violate this restriction will cause handlers to throw.
     * Default: {}()/\@:
     *
     * NOTE: The default set is required for PSR-6 compliance.
     */
    public string $reservedCharacters = '{}()/\@:';

    /**
     * --------------------------------------------------------------------------
     * File settings
     * --------------------------------------------------------------------------
     *
     * Your file storage preferences can be specified below, if you are using
     * the File driver.
     *
     * @var array{storePath?: string, mode?: int}
     */
    public array $file = [
        'storePath' => WRITEPATH . 'cache/',
        'mode'      => 0640,
    ];

    /**
     * -------------------------------------------------------------------------
     * Memcached settings
     * -------------------------------------------------------------------------
     *
     * Your Memcached servers can be specified below, if you are using
     * the Memcached drivers.
     *
     * @see https://codeigniter.com/user_guide/libraries/caching.html#memcached
     *
     * @var array{host?: string, port?: int, weight?: int, raw?: bool}
     */
    public array $memcached = [
        'host'   => '127.0.0.1',
        'port'   => 11211,
        'weight' => 1,
        'raw'    => false,
    ];

    /**
     * -------------------------------------------------------------------------
     * Redis settings
     * -------------------------------------------------------------------------
     *
     * Your Redis server can be specified below, if you are using
     * the Redis or Predis drivers.
     *
     * @var array{host?: string, password?: string|null, port?: int, timeout?: int, database?: int}
     */
    public array $redis = [
        'host'     => '127.0.0.1',
        'password' => null,
        'port'     => 6379,
        'timeout'  => 0,
        'database' => 0,
    ];

    /**
     * --------------------------------------------------------------------------
     * Available Cache Handlers
     * --------------------------------------------------------------------------
     *
     * This is an array of cache engine alias' and class names. Only engines
     * that are listed here are allowed to be used.
     *
     * @var array<string, class-string<CacheInterface>>
     */
    public array $validHandlers = [
        'dummy'     => DummyHandler::class,
        'file'      => FileHandler::class,
        'memcached' => MemcachedHandler::class,
        'predis'    => PredisHandler::class,
        'redis'     => RedisHandler::class,
        'wincache'  => WincacheHandler::class,
    ];

    /**
     * --------------------------------------------------------------------------
     * Web Page Caching: Cache Include Query String
     * --------------------------------------------------------------------------
     *
     * Whether to take the URL query string into consideration when generating
     * output cache files. Valid options are:
     *
     *    false = Disabled
     *    true  = Enabled, take all query parameters into account.
     *            Please be aware that this may result in numerous cache
     *            files generated for the same page over and over again.
     *    ['q'] = Enabled, but only take into account the specified list
     *            of query parameters.
     *
     * @var bool|list<string>
     */
    public $cacheQueryString = false;
}


##########################################################
FILE PATH: app/Config/Constants.php
##########################################################
<?php

/*
 | --------------------------------------------------------------------
 | App Namespace
 | --------------------------------------------------------------------
 |
 | This defines the default Namespace that is used throughout
 | CodeIgniter to refer to the Application directory. Change
 | this constant to change the namespace that all application
 | classes should use.
 |
 | NOTE: changing this will require manually modifying the
 | existing namespaces of App\* namespaced-classes.
 */
defined('APP_NAMESPACE') || define('APP_NAMESPACE', 'App');

/*
 | --------------------------------------------------------------------------
 | Composer Path
 | --------------------------------------------------------------------------
 |
 | The path that Composer's autoload file is expected to live. By default,
 | the vendor folder is in the Root directory, but you can customize that here.
 */
defined('COMPOSER_PATH') || define('COMPOSER_PATH', ROOTPATH . 'vendor/autoload.php');

/*
 |--------------------------------------------------------------------------
 | Timing Constants
 |--------------------------------------------------------------------------
 |
 | Provide simple ways to work with the myriad of PHP functions that
 | require information to be in seconds.
 */
defined('SECOND') || define('SECOND', 1);
defined('MINUTE') || define('MINUTE', 60);
defined('HOUR')   || define('HOUR', 3600);
defined('DAY')    || define('DAY', 86400);
defined('WEEK')   || define('WEEK', 604800);
defined('MONTH')  || define('MONTH', 2_592_000);
defined('YEAR')   || define('YEAR', 31_536_000);
defined('DECADE') || define('DECADE', 315_360_000);

/*
 | --------------------------------------------------------------------------
 | Exit Status Codes
 | --------------------------------------------------------------------------
 |
 | Used to indicate the conditions under which the script is exit()ing.
 | While there is no universal standard for error codes, there are some
 | broad conventions.  Three such conventions are mentioned below, for
 | those who wish to make use of them.  The CodeIgniter defaults were
 | chosen for the least overlap with these conventions, while still
 | leaving room for others to be defined in future versions and user
 | applications.
 |
 | The three main conventions used for determining exit status codes
 | are as follows:
 |
 |    Standard C/C++ Library (stdlibc):
 |       http://www.gnu.org/software/libc/manual/html_node/Exit-Status.html
 |       (This link also contains other GNU-specific conventions)
 |    BSD sysexits.h:
 |       http://www.gsp.com/cgi-bin/man.cgi?section=3&topic=sysexits
 |    Bash scripting:
 |       http://tldp.org/LDP/abs/html/exitcodes.html
 |
 */
defined('EXIT_SUCCESS')        || define('EXIT_SUCCESS', 0);        // no errors
defined('EXIT_ERROR')          || define('EXIT_ERROR', 1);          // generic error
defined('EXIT_CONFIG')         || define('EXIT_CONFIG', 3);         // configuration error
defined('EXIT_UNKNOWN_FILE')   || define('EXIT_UNKNOWN_FILE', 4);   // file not found
defined('EXIT_UNKNOWN_CLASS')  || define('EXIT_UNKNOWN_CLASS', 5);  // unknown class
defined('EXIT_UNKNOWN_METHOD') || define('EXIT_UNKNOWN_METHOD', 6); // unknown class member
defined('EXIT_USER_INPUT')     || define('EXIT_USER_INPUT', 7);     // invalid user input
defined('EXIT_DATABASE')       || define('EXIT_DATABASE', 8);       // database error
defined('EXIT__AUTO_MIN')      || define('EXIT__AUTO_MIN', 9);      // lowest automatically-assigned error code
defined('EXIT__AUTO_MAX')      || define('EXIT__AUTO_MAX', 125);    // highest automatically-assigned error code


##########################################################
FILE PATH: app/Config/ContentSecurityPolicy.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

/**
 * Stores the default settings for the ContentSecurityPolicy, if you
 * choose to use it. The values here will be read in and set as defaults
 * for the site. If needed, they can be overridden on a page-by-page basis.
 *
 * Suggested reference for explanations:
 *
 * @see https://www.html5rocks.com/en/tutorials/security/content-security-policy/
 */
class ContentSecurityPolicy extends BaseConfig
{
    // -------------------------------------------------------------------------
    // Broadbrush CSP management
    // -------------------------------------------------------------------------

    /**
     * Default CSP report context
     */
    public bool $reportOnly = false;

    /**
     * Specifies a URL where a browser will send reports
     * when a content security policy is violated.
     */
    public ?string $reportURI = null;

    /**
     * Instructs user agents to rewrite URL schemes, changing
     * HTTP to HTTPS. This directive is for websites with
     * large numbers of old URLs that need to be rewritten.
     */
    public bool $upgradeInsecureRequests = false;

    // -------------------------------------------------------------------------
    // Sources allowed
    // NOTE: once you set a policy to 'none', it cannot be further restricted
    // -------------------------------------------------------------------------

    /**
     * Will default to self if not overridden
     *
     * @var list<string>|string|null
     */
    public $defaultSrc;

    /**
     * Lists allowed scripts' URLs.
     *
     * @var list<string>|string
     */
    public $scriptSrc = 'self';

    /**
     * Lists allowed stylesheets' URLs.
     *
     * @var list<string>|string
     */
    public $styleSrc = 'self';

    /**
     * Defines the origins from which images can be loaded.
     *
     * @var list<string>|string
     */
    public $imageSrc = 'self';

    /**
     * Restricts the URLs that can appear in a page's `<base>` element.
     *
     * Will default to self if not overridden
     *
     * @var list<string>|string|null
     */
    public $baseURI;

    /**
     * Lists the URLs for workers and embedded frame contents
     *
     * @var list<string>|string
     */
    public $childSrc = 'self';

    /**
     * Limits the origins that you can connect to (via XHR,
     * WebSockets, and EventSource).
     *
     * @var list<string>|string
     */
    public $connectSrc = 'self';

    /**
     * Specifies the origins that can serve web fonts.
     *
     * @var list<string>|string
     */
    public $fontSrc;

    /**
     * Lists valid endpoints for submission from `<form>` tags.
     *
     * @var list<string>|string
     */
    public $formAction = 'self';

    /**
     * Specifies the sources that can embed the current page.
     * This directive applies to `<frame>`, `<iframe>`, `<embed>`,
     * and `<applet>` tags. This directive can't be used in
     * `<meta>` tags and applies only to non-HTML resources.
     *
     * @var list<string>|string|null
     */
    public $frameAncestors;

    /**
     * The frame-src directive restricts the URLs which may
     * be loaded into nested browsing contexts.
     *
     * @var list<string>|string|null
     */
    public $frameSrc;

    /**
     * Restricts the origins allowed to deliver video and audio.
     *
     * @var list<string>|string|null
     */
    public $mediaSrc;

    /**
     * Allows control over Flash and other plugins.
     *
     * @var list<string>|string
     */
    public $objectSrc = 'self';

    /**
     * @var list<string>|string|null
     */
    public $manifestSrc;

    /**
     * Limits the kinds of plugins a page may invoke.
     *
     * @var list<string>|string|null
     */
    public $pluginTypes;

    /**
     * List of actions allowed.
     *
     * @var list<string>|string|null
     */
    public $sandbox;

    /**
     * Nonce tag for style
     */
    public string $styleNonceTag = '{csp-style-nonce}';

    /**
     * Nonce tag for script
     */
    public string $scriptNonceTag = '{csp-script-nonce}';

    /**
     * Replace nonce tag automatically
     */
    public bool $autoNonce = true;
}


##########################################################
FILE PATH: app/Config/Cookie.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use DateTimeInterface;

class Cookie extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Cookie Prefix
     * --------------------------------------------------------------------------
     *
     * Set a cookie name prefix if you need to avoid collisions.
     */
    public string $prefix = '';

    /**
     * --------------------------------------------------------------------------
     * Cookie Expires Timestamp
     * --------------------------------------------------------------------------
     *
     * Default expires timestamp for cookies. Setting this to `0` will mean the
     * cookie will not have the `Expires` attribute and will behave as a session
     * cookie.
     *
     * @var DateTimeInterface|int|string
     */
    public $expires = 0;

    /**
     * --------------------------------------------------------------------------
     * Cookie Path
     * --------------------------------------------------------------------------
     *
     * Typically will be a forward slash.
     */
    public string $path = '/';

    /**
     * --------------------------------------------------------------------------
     * Cookie Domain
     * --------------------------------------------------------------------------
     *
     * Set to `.your-domain.com` for site-wide cookies.
     */
    public string $domain = '';

    /**
     * --------------------------------------------------------------------------
     * Cookie Secure
     * --------------------------------------------------------------------------
     *
     * Cookie will only be set if a secure HTTPS connection exists.
     */
    public bool $secure = false;

    /**
     * --------------------------------------------------------------------------
     * Cookie HTTPOnly
     * --------------------------------------------------------------------------
     *
     * Cookie will only be accessible via HTTP(S) (no JavaScript).
     */
    public bool $httponly = true;

    /**
     * --------------------------------------------------------------------------
     * Cookie SameSite
     * --------------------------------------------------------------------------
     *
     * Configure cookie SameSite setting. Allowed values are:
     * - None
     * - Lax
     * - Strict
     * - ''
     *
     * Alternatively, you can use the constant names:
     * - `Cookie::SAMESITE_NONE`
     * - `Cookie::SAMESITE_LAX`
     * - `Cookie::SAMESITE_STRICT`
     *
     * Defaults to `Lax` for compatibility with modern browsers. Setting `''`
     * (empty string) means default SameSite attribute set by browsers (`Lax`)
     * will be set on cookies. If set to `None`, `$secure` must also be set.
     *
     * @var ''|'Lax'|'None'|'Strict'
     */
    public string $samesite = 'Lax';

    /**
     * --------------------------------------------------------------------------
     * Cookie Raw
     * --------------------------------------------------------------------------
     *
     * This flag allows setting a "raw" cookie, i.e., its name and value are
     * not URL encoded using `rawurlencode()`.
     *
     * If this is set to `true`, cookie names should be compliant of RFC 2616's
     * list of allowed characters.
     *
     * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes
     * @see https://tools.ietf.org/html/rfc2616#section-2.2
     */
    public bool $raw = false;
}


##########################################################
FILE PATH: app/Config/Cors.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

/**
 * Cross-Origin Resource Sharing (CORS) Configuration
 *
 * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS
 */
class Cors extends BaseConfig
{
    /**
     * The default CORS configuration.
     *
     * @var array{
     *      allowedOrigins: list<string>,
     *      allowedOriginsPatterns: list<string>,
     *      supportsCredentials: bool,
     *      allowedHeaders: list<string>,
     *      exposedHeaders: list<string>,
     *      allowedMethods: list<string>,
     *      maxAge: int,
     *  }
     */
    public array $default = [
        /**
         * Origins for the `Access-Control-Allow-Origin` header.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin
         *
         * E.g.:
         *   - ['http://localhost:8080']
         *   - ['https://www.example.com']
         */
        'allowedOrigins' => [],

        /**
         * Origin regex patterns for the `Access-Control-Allow-Origin` header.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin
         *
         * NOTE: A pattern specified here is part of a regular expression. It will
         *       be actually `#\A<pattern>\z#`.
         *
         * E.g.:
         *   - ['https://\w+\.example\.com']
         */
        'allowedOriginsPatterns' => [],

        /**
         * Weather to send the `Access-Control-Allow-Credentials` header.
         *
         * The Access-Control-Allow-Credentials response header tells browsers whether
         * the server allows cross-origin HTTP requests to include credentials.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials
         */
        'supportsCredentials' => false,

        /**
         * Set headers to allow.
         *
         * The Access-Control-Allow-Headers response header is used in response to
         * a preflight request which includes the Access-Control-Request-Headers to
         * indicate which HTTP headers can be used during the actual request.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Headers
         */
        'allowedHeaders' => [],

        /**
         * Set headers to expose.
         *
         * The Access-Control-Expose-Headers response header allows a server to
         * indicate which response headers should be made available to scripts running
         * in the browser, in response to a cross-origin request.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Expose-Headers
         */
        'exposedHeaders' => [],

        /**
         * Set methods to allow.
         *
         * The Access-Control-Allow-Methods response header specifies one or more
         * methods allowed when accessing a resource in response to a preflight
         * request.
         *
         * E.g.:
         *   - ['GET', 'POST', 'PUT', 'DELETE']
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Methods
         */
        'allowedMethods' => [],

        /**
         * Set how many seconds the results of a preflight request can be cached.
         *
         * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age
         */
        'maxAge' => 7200,
    ];
}


##########################################################
FILE PATH: app/Config/Database.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Database\Config;

/**
 * Database Configuration
 */
class Database extends Config
{
    /**
     * The directory that holds the Migrations and Seeds directories.
     */
    public string $filesPath = APPPATH . 'Database' . DIRECTORY_SEPARATOR;

    /**
     * Lets you choose which connection group to use if no other is specified.
     */
    public string $defaultGroup = 'default';

    /**
     * The default database connection.
     *
     * @var array<string, mixed>
     */
    public array $default = [
        'DSN'          => '',
        'hostname'     => 'localhost',
        'username'     => '',
        'password'     => '',
        'database'     => '',
        'DBDriver'     => 'MySQLi',
        'DBPrefix'     => '',
        'pConnect'     => false,
        'DBDebug'      => true,
        'charset'      => 'utf8mb4',
        'DBCollat'     => 'utf8mb4_general_ci',
        'swapPre'      => '',
        'encrypt'      => false,
        'compress'     => false,
        'strictOn'     => false,
        'failover'     => [],
        'port'         => 3306,
        'numberNative' => false,
        'foundRows'    => false,
        'dateFormat'   => [
            'date'     => 'Y-m-d',
            'datetime' => 'Y-m-d H:i:s',
            'time'     => 'H:i:s',
        ],
    ];

    //    /**
    //     * Sample database connection for SQLite3.
    //     *
    //     * @var array<string, mixed>
    //     */
    //    public array $default = [
    //        'database'    => 'database.db',
    //        'DBDriver'    => 'SQLite3',
    //        'DBPrefix'    => '',
    //        'DBDebug'     => true,
    //        'swapPre'     => '',
    //        'failover'    => [],
    //        'foreignKeys' => true,
    //        'busyTimeout' => 1000,
    //        'synchronous' => null,
    //        'dateFormat'  => [
    //            'date'     => 'Y-m-d',
    //            'datetime' => 'Y-m-d H:i:s',
    //            'time'     => 'H:i:s',
    //        ],
    //    ];

    //    /**
    //     * Sample database connection for Postgre.
    //     *
    //     * @var array<string, mixed>
    //     */
    //    public array $default = [
    //        'DSN'        => '',
    //        'hostname'   => 'localhost',
    //        'username'   => 'root',
    //        'password'   => 'root',
    //        'database'   => 'ci4',
    //        'schema'     => 'public',
    //        'DBDriver'   => 'Postgre',
    //        'DBPrefix'   => '',
    //        'pConnect'   => false,
    //        'DBDebug'    => true,
    //        'charset'    => 'utf8',
    //        'swapPre'    => '',
    //        'failover'   => [],
    //        'port'       => 5432,
    //        'dateFormat' => [
    //            'date'     => 'Y-m-d',
    //            'datetime' => 'Y-m-d H:i:s',
    //            'time'     => 'H:i:s',
    //        ],
    //    ];

    //    /**
    //     * Sample database connection for SQLSRV.
    //     *
    //     * @var array<string, mixed>
    //     */
    //    public array $default = [
    //        'DSN'        => '',
    //        'hostname'   => 'localhost',
    //        'username'   => 'root',
    //        'password'   => 'root',
    //        'database'   => 'ci4',
    //        'schema'     => 'dbo',
    //        'DBDriver'   => 'SQLSRV',
    //        'DBPrefix'   => '',
    //        'pConnect'   => false,
    //        'DBDebug'    => true,
    //        'charset'    => 'utf8',
    //        'swapPre'    => '',
    //        'encrypt'    => false,
    //        'failover'   => [],
    //        'port'       => 1433,
    //        'dateFormat' => [
    //            'date'     => 'Y-m-d',
    //            'datetime' => 'Y-m-d H:i:s',
    //            'time'     => 'H:i:s',
    //        ],
    //    ];

    //    /**
    //     * Sample database connection for OCI8.
    //     *
    //     * You may need the following environment variables:
    //     *   NLS_LANG                = 'AMERICAN_AMERICA.UTF8'
    //     *   NLS_DATE_FORMAT         = 'YYYY-MM-DD HH24:MI:SS'
    //     *   NLS_TIMESTAMP_FORMAT    = 'YYYY-MM-DD HH24:MI:SS'
    //     *   NLS_TIMESTAMP_TZ_FORMAT = 'YYYY-MM-DD HH24:MI:SS'
    //     *
    //     * @var array<string, mixed>
    //     */
    //    public array $default = [
    //        'DSN'        => 'localhost:1521/XEPDB1',
    //        'username'   => 'root',
    //        'password'   => 'root',
    //        'DBDriver'   => 'OCI8',
    //        'DBPrefix'   => '',
    //        'pConnect'   => false,
    //        'DBDebug'    => true,
    //        'charset'    => 'AL32UTF8',
    //        'swapPre'    => '',
    //        'failover'   => [],
    //        'dateFormat' => [
    //            'date'     => 'Y-m-d',
    //            'datetime' => 'Y-m-d H:i:s',
    //            'time'     => 'H:i:s',
    //        ],
    //    ];

    /**
     * This database connection is used when running PHPUnit database tests.
     *
     * @var array<string, mixed>
     */
    public array $tests = [
        'DSN'         => '',
        'hostname'    => '127.0.0.1',
        'username'    => '',
        'password'    => '',
        'database'    => ':memory:',
        'DBDriver'    => 'SQLite3',
        'DBPrefix'    => 'db_',  // Needed to ensure we're working correctly with prefixes live. DO NOT REMOVE FOR CI DEVS
        'pConnect'    => false,
        'DBDebug'     => true,
        'charset'     => 'utf8',
        'DBCollat'    => '',
        'swapPre'     => '',
        'encrypt'     => false,
        'compress'    => false,
        'strictOn'    => false,
        'failover'    => [],
        'port'        => 3306,
        'foreignKeys' => true,
        'busyTimeout' => 1000,
        'dateFormat'  => [
            'date'     => 'Y-m-d',
            'datetime' => 'Y-m-d H:i:s',
            'time'     => 'H:i:s',
        ],
    ];

    public function __construct()
    {
        parent::__construct();

        // Ensure that we always set the database group to 'tests' if
        // we are currently running an automated test suite, so that
        // we don't overwrite live data on accident.
        if (ENVIRONMENT === 'testing') {
            $this->defaultGroup = 'tests';
        }
    }
}


##########################################################
FILE PATH: app/Config/DocTypes.php
##########################################################
<?php

namespace Config;

class DocTypes
{
    /**
     * List of valid document types.
     *
     * @var array<string, string>
     */
    public array $list = [
        'xhtml11'           => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">',
        'xhtml1-strict'     => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">',
        'xhtml1-trans'      => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',
        'xhtml1-frame'      => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">',
        'xhtml-basic11'     => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">',
        'html5'             => '<!DOCTYPE html>',
        'html4-strict'      => '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',
        'html4-trans'       => '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',
        'html4-frame'       => '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">',
        'mathml1'           => '<!DOCTYPE math SYSTEM "http://www.w3.org/Math/DTD/mathml1/mathml.dtd">',
        'mathml2'           => '<!DOCTYPE math PUBLIC "-//W3C//DTD MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/mathml2.dtd">',
        'svg10'             => '<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">',
        'svg11'             => '<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',
        'svg11-basic'       => '<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1 Basic//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-basic.dtd">',
        'svg11-tiny'        => '<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1 Tiny//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-tiny.dtd">',
        'xhtml-math-svg-xh' => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">',
        'xhtml-math-svg-sh' => '<!DOCTYPE svg:svg PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">',
        'xhtml-rdfa-1'      => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">',
        'xhtml-rdfa-2'      => '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.1//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd">',
    ];

    /**
     * Whether to remove the solidus (`/`) character for void HTML elements (e.g. `<input>`)
     * for HTML5 compatibility.
     *
     * Set to:
     *    `true` - to be HTML5 compatible
     *    `false` - to be XHTML compatible
     */
    public bool $html5 = true;
}


##########################################################
FILE PATH: app/Config/Email.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Email extends BaseConfig
{
    public string $fromEmail  = '';
    public string $fromName   = '';
    public string $recipients = '';

    /**
     * The "user agent"
     */
    public string $userAgent = 'CodeIgniter';

    /**
     * The mail sending protocol: mail, sendmail, smtp
     */
    public string $protocol = 'mail';

    /**
     * The server path to Sendmail.
     */
    public string $mailPath = '/usr/sbin/sendmail';

    /**
     * SMTP Server Hostname
     */
    public string $SMTPHost = '';

    /**
     * SMTP Username
     */
    public string $SMTPUser = '';

    /**
     * SMTP Password
     */
    public string $SMTPPass = '';

    /**
     * SMTP Port
     */
    public int $SMTPPort = 25;

    /**
     * SMTP Timeout (in seconds)
     */
    public int $SMTPTimeout = 5;

    /**
     * Enable persistent SMTP connections
     */
    public bool $SMTPKeepAlive = false;

    /**
     * SMTP Encryption.
     *
     * @var string '', 'tls' or 'ssl'. 'tls' will issue a STARTTLS command
     *             to the server. 'ssl' means implicit SSL. Connection on port
     *             465 should set this to ''.
     */
    public string $SMTPCrypto = 'tls';

    /**
     * Enable word-wrap
     */
    public bool $wordWrap = true;

    /**
     * Character count to wrap at
     */
    public int $wrapChars = 76;

    /**
     * Type of mail, either 'text' or 'html'
     */
    public string $mailType = 'text';

    /**
     * Character set (utf-8, iso-8859-1, etc.)
     */
    public string $charset = 'UTF-8';

    /**
     * Whether to validate the email address
     */
    public bool $validate = false;

    /**
     * Email Priority. 1 = highest. 5 = lowest. 3 = normal
     */
    public int $priority = 3;

    /**
     * Newline character. (Use ‚Äú\r\n‚Äù to comply with RFC 822)
     */
    public string $CRLF = "\r\n";

    /**
     * Newline character. (Use ‚Äú\r\n‚Äù to comply with RFC 822)
     */
    public string $newline = "\r\n";

    /**
     * Enable BCC Batch Mode.
     */
    public bool $BCCBatchMode = false;

    /**
     * Number of emails in each BCC batch
     */
    public int $BCCBatchSize = 200;

    /**
     * Enable notify message from server
     */
    public bool $DSN = false;
}


##########################################################
FILE PATH: app/Config/Encryption.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

/**
 * Encryption configuration.
 *
 * These are the settings used for encryption, if you don't pass a parameter
 * array to the encrypter for creation/initialization.
 */
class Encryption extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Encryption Key Starter
     * --------------------------------------------------------------------------
     *
     * If you use the Encryption class you must set an encryption key (seed).
     * You need to ensure it is long enough for the cipher and mode you plan to use.
     * See the user guide for more info.
     */
    public string $key = '';

    /**
     * --------------------------------------------------------------------------
     * Encryption Driver to Use
     * --------------------------------------------------------------------------
     *
     * One of the supported encryption drivers.
     *
     * Available drivers:
     * - OpenSSL
     * - Sodium
     */
    public string $driver = 'OpenSSL';

    /**
     * --------------------------------------------------------------------------
     * SodiumHandler's Padding Length in Bytes
     * --------------------------------------------------------------------------
     *
     * This is the number of bytes that will be padded to the plaintext message
     * before it is encrypted. This value should be greater than zero.
     *
     * See the user guide for more information on padding.
     */
    public int $blockSize = 16;

    /**
     * --------------------------------------------------------------------------
     * Encryption digest
     * --------------------------------------------------------------------------
     *
     * HMAC digest to use, e.g. 'SHA512' or 'SHA256'. Default value is 'SHA512'.
     */
    public string $digest = 'SHA512';

    /**
     * Whether the cipher-text should be raw. If set to false, then it will be base64 encoded.
     * This setting is only used by OpenSSLHandler.
     *
     * Set to false for CI3 Encryption compatibility.
     */
    public bool $rawData = true;

    /**
     * Encryption key info.
     * This setting is only used by OpenSSLHandler.
     *
     * Set to 'encryption' for CI3 Encryption compatibility.
     */
    public string $encryptKeyInfo = '';

    /**
     * Authentication key info.
     * This setting is only used by OpenSSLHandler.
     *
     * Set to 'authentication' for CI3 Encryption compatibility.
     */
    public string $authKeyInfo = '';

    /**
     * Cipher to use.
     * This setting is only used by OpenSSLHandler.
     *
     * Set to 'AES-128-CBC' to decrypt encrypted data that encrypted
     * by CI3 Encryption default configuration.
     */
    public string $cipher = 'AES-256-CTR';
}


##########################################################
FILE PATH: app/Config/Events.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Events\Events;
use CodeIgniter\Exceptions\FrameworkException;
use CodeIgniter\HotReloader\HotReloader;

/*
 * --------------------------------------------------------------------
 * Application Events
 * --------------------------------------------------------------------
 * Events allow you to tap into the execution of the program without
 * modifying or extending core files. This file provides a central
 * location to define your events, though they can always be added
 * at run-time, also, if needed.
 *
 * You create code that can execute by subscribing to events with
 * the 'on()' method. This accepts any form of callable, including
 * Closures, that will be executed when the event is triggered.
 *
 * Example:
 *      Events::on('create', [$myInstance, 'myMethod']);
 */

Events::on('pre_system', static function (): void {
    if (ENVIRONMENT !== 'testing') {
        if (ini_get('zlib.output_compression')) {
            throw FrameworkException::forEnabledZlibOutputCompression();
        }

        while (ob_get_level() > 0) {
            ob_end_flush();
        }

        ob_start(static fn ($buffer) => $buffer);
    }

    /*
     * --------------------------------------------------------------------
     * Debug Toolbar Listeners.
     * --------------------------------------------------------------------
     * If you delete, they will no longer be collected.
     */
    if (CI_DEBUG && ! is_cli()) {
        Events::on('DBQuery', 'CodeIgniter\Debug\Toolbar\Collectors\Database::collect');
        service('toolbar')->respond();
        // Hot Reload route - for framework use on the hot reloader.
        if (ENVIRONMENT === 'development') {
            service('routes')->get('__hot-reload', static function (): void {
                (new HotReloader())->run();
            });
        }
    }
});


##########################################################
FILE PATH: app/Config/Exceptions.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Debug\ExceptionHandler;
use CodeIgniter\Debug\ExceptionHandlerInterface;
use Psr\Log\LogLevel;
use Throwable;

/**
 * Setup how the exception handler works.
 */
class Exceptions extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * LOG EXCEPTIONS?
     * --------------------------------------------------------------------------
     * If true, then exceptions will be logged
     * through Services::Log.
     *
     * Default: true
     */
    public bool $log = true;

    /**
     * --------------------------------------------------------------------------
     * DO NOT LOG STATUS CODES
     * --------------------------------------------------------------------------
     * Any status codes here will NOT be logged if logging is turned on.
     * By default, only 404 (Page Not Found) exceptions are ignored.
     *
     * @var list<int>
     */
    public array $ignoreCodes = [404];

    /**
     * --------------------------------------------------------------------------
     * Error Views Path
     * --------------------------------------------------------------------------
     * This is the path to the directory that contains the 'cli' and 'html'
     * directories that hold the views used to generate errors.
     *
     * Default: APPPATH.'Views/errors'
     */
    public string $errorViewPath = APPPATH . 'Views/errors';

    /**
     * --------------------------------------------------------------------------
     * HIDE FROM DEBUG TRACE
     * --------------------------------------------------------------------------
     * Any data that you would like to hide from the debug trace.
     * In order to specify 2 levels, use "/" to separate.
     * ex. ['server', 'setup/password', 'secret_token']
     *
     * @var list<string>
     */
    public array $sensitiveDataInTrace = [];

    /**
     * --------------------------------------------------------------------------
     * WHETHER TO THROW AN EXCEPTION ON DEPRECATED ERRORS
     * --------------------------------------------------------------------------
     * If set to `true`, DEPRECATED errors are only logged and no exceptions are
     * thrown. This option also works for user deprecations.
     */
    public bool $logDeprecations = true;

    /**
     * --------------------------------------------------------------------------
     * LOG LEVEL THRESHOLD FOR DEPRECATIONS
     * --------------------------------------------------------------------------
     * If `$logDeprecations` is set to `true`, this sets the log level
     * to which the deprecation will be logged. This should be one of the log
     * levels recognized by PSR-3.
     *
     * The related `Config\Logger::$threshold` should be adjusted, if needed,
     * to capture logging the deprecations.
     */
    public string $deprecationLogLevel = LogLevel::WARNING;

    /*
     * DEFINE THE HANDLERS USED
     * --------------------------------------------------------------------------
     * Given the HTTP status code, returns exception handler that
     * should be used to deal with this error. By default, it will run CodeIgniter's
     * default handler and display the error information in the expected format
     * for CLI, HTTP, or AJAX requests, as determined by is_cli() and the expected
     * response format.
     *
     * Custom handlers can be returned if you want to handle one or more specific
     * error codes yourself like:
     *
     *      if (in_array($statusCode, [400, 404, 500])) {
     *          return new \App\Libraries\MyExceptionHandler();
     *      }
     *      if ($exception instanceOf PageNotFoundException) {
     *          return new \App\Libraries\MyExceptionHandler();
     *      }
     */
    public function handler(int $statusCode, Throwable $exception): ExceptionHandlerInterface
    {
        return new ExceptionHandler($this);
    }
}


##########################################################
FILE PATH: app/Config/Feature.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

/**
 * Enable/disable backward compatibility breaking features.
 */
class Feature extends BaseConfig
{
    /**
     * Use improved new auto routing instead of the legacy version.
     */
    public bool $autoRoutesImproved = true;

    /**
     * Use filter execution order in 4.4 or before.
     */
    public bool $oldFilterOrder = false;

    /**
     * The behavior of `limit(0)` in Query Builder.
     *
     * If true, `limit(0)` returns all records. (the behavior of 4.4.x or before in version 4.x.)
     * If false, `limit(0)` returns no records. (the behavior of 3.1.9 or later in version 3.x.)
     */
    public bool $limitZeroAsAll = true;

    /**
     * Use strict location negotiation.
     *
     * By default, the locale is selected based on a loose comparison of the language code (ISO 639-1)
     * Enabling strict comparison will also consider the region code (ISO 3166-1 alpha-2).
     */
    public bool $strictLocaleNegotiation = false;
}


##########################################################
FILE PATH: app/Config/Filters.php
##########################################################
<?php namespace Config;
use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Filters\CSRF;
use CodeIgniter\Filters\DebugToolbar;
use CodeIgniter\Filters\Honeypot;
use App\Filters\AuthGuard;

class Filters extends BaseConfig {
    public $aliases = [
        'csrf'     => CSRF::class,
        'toolbar'  => DebugToolbar::class,
        'honeypot' => Honeypot::class,
        'auth'     => AuthGuard::class, // PENTING: Alias untuk AuthGuard
    ];

    public $globals = [
        'before' => [
            // 'honeypot',
            'csrf', // CSRF dimatikan global dulu agar tidak konflik dengan login manual
        ],
        'after' => [
            'toolbar',
        ],
    ];

    public $methods = [];

    public $filters = [
        // Lindungi halaman Admin dan Panel dari akses tanpa login
        'auth' => ['before' => ['admin/*', 'panel/*', 'panel']]
    ];
}


##########################################################
FILE PATH: app/Config/ForeignCharacters.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\ForeignCharacters as BaseForeignCharacters;

/**
 * @immutable
 */
class ForeignCharacters extends BaseForeignCharacters
{
}


##########################################################
FILE PATH: app/Config/Format.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Format\JSONFormatter;
use CodeIgniter\Format\XMLFormatter;

class Format extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Available Response Formats
     * --------------------------------------------------------------------------
     *
     * When you perform content negotiation with the request, these are the
     * available formats that your application supports. This is currently
     * only used with the API\ResponseTrait. A valid Formatter must exist
     * for the specified format.
     *
     * These formats are only checked when the data passed to the respond()
     * method is an array.
     *
     * @var list<string>
     */
    public array $supportedResponseFormats = [
        'application/json',
        'application/xml', // machine-readable XML
        'text/xml', // human-readable XML
    ];

    /**
     * --------------------------------------------------------------------------
     * Formatters
     * --------------------------------------------------------------------------
     *
     * Lists the class to use to format responses with of a particular type.
     * For each mime type, list the class that should be used. Formatters
     * can be retrieved through the getFormatter() method.
     *
     * @var array<string, string>
     */
    public array $formatters = [
        'application/json' => JSONFormatter::class,
        'application/xml'  => XMLFormatter::class,
        'text/xml'         => XMLFormatter::class,
    ];

    /**
     * --------------------------------------------------------------------------
     * Formatters Options
     * --------------------------------------------------------------------------
     *
     * Additional Options to adjust default formatters behaviour.
     * For each mime type, list the additional options that should be used.
     *
     * @var array<string, int>
     */
    public array $formatterOptions = [
        'application/json' => JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES,
        'application/xml'  => 0,
        'text/xml'         => 0,
    ];
}


##########################################################
FILE PATH: app/Config/Generators.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Generators extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Generator Commands' Views
     * --------------------------------------------------------------------------
     *
     * This array defines the mapping of generator commands to the view files
     * they are using. If you need to customize them for your own, copy these
     * view files in your own folder and indicate the location here.
     *
     * You will notice that the views have special placeholders enclosed in
     * curly braces `{...}`. These placeholders are used internally by the
     * generator commands in processing replacements, thus you are warned
     * not to delete them or modify the names. If you will do so, you may
     * end up disrupting the scaffolding process and throw errors.
     *
     * YOU HAVE BEEN WARNED!
     *
     * @var array<string, array<string, string>|string>
     */
    public array $views = [
        'make:cell' => [
            'class' => 'CodeIgniter\Commands\Generators\Views\cell.tpl.php',
            'view'  => 'CodeIgniter\Commands\Generators\Views\cell_view.tpl.php',
        ],
        'make:command'      => 'CodeIgniter\Commands\Generators\Views\command.tpl.php',
        'make:config'       => 'CodeIgniter\Commands\Generators\Views\config.tpl.php',
        'make:controller'   => 'CodeIgniter\Commands\Generators\Views\controller.tpl.php',
        'make:entity'       => 'CodeIgniter\Commands\Generators\Views\entity.tpl.php',
        'make:filter'       => 'CodeIgniter\Commands\Generators\Views\filter.tpl.php',
        'make:migration'    => 'CodeIgniter\Commands\Generators\Views\migration.tpl.php',
        'make:model'        => 'CodeIgniter\Commands\Generators\Views\model.tpl.php',
        'make:seeder'       => 'CodeIgniter\Commands\Generators\Views\seeder.tpl.php',
        'make:validation'   => 'CodeIgniter\Commands\Generators\Views\validation.tpl.php',
        'session:migration' => 'CodeIgniter\Commands\Generators\Views\migration.tpl.php',
    ];
}


##########################################################
FILE PATH: app/Config/Honeypot.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Honeypot extends BaseConfig
{
    /**
     * Makes Honeypot visible or not to human
     */
    public bool $hidden = true;

    /**
     * Honeypot Label Content
     */
    public string $label = 'Fill This Field';

    /**
     * Honeypot Field Name
     */
    public string $name = 'honeypot';

    /**
     * Honeypot HTML Template
     */
    public string $template = '<label>{label}</label><input type="text" name="{name}" value="">';

    /**
     * Honeypot container
     *
     * If you enabled CSP, you can remove `style="display:none"`.
     */
    public string $container = '<div style="display:none">{template}</div>';

    /**
     * The id attribute for Honeypot container tag
     *
     * Used when CSP is enabled.
     */
    public string $containerId = 'hpc';
}


##########################################################
FILE PATH: app/Config/Images.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Images\Handlers\GDHandler;
use CodeIgniter\Images\Handlers\ImageMagickHandler;

class Images extends BaseConfig
{
    /**
     * Default handler used if no other handler is specified.
     */
    public string $defaultHandler = 'gd';

    /**
     * The path to the image library.
     * Required for ImageMagick, GraphicsMagick, or NetPBM.
     */
    public string $libraryPath = '/usr/local/bin/convert';

    /**
     * The available handler classes.
     *
     * @var array<string, string>
     */
    public array $handlers = [
        'gd'      => GDHandler::class,
        'imagick' => ImageMagickHandler::class,
    ];
}


##########################################################
FILE PATH: app/Config/Kint.php
##########################################################
<?php

namespace Config;

use Kint\Parser\ConstructablePluginInterface;
use Kint\Renderer\Rich\TabPluginInterface;
use Kint\Renderer\Rich\ValuePluginInterface;

/**
 * --------------------------------------------------------------------------
 * Kint
 * --------------------------------------------------------------------------
 *
 * We use Kint's `RichRenderer` and `CLIRenderer`. This area contains options
 * that you can set to customize how Kint works for you.
 *
 * @see https://kint-php.github.io/kint/ for details on these settings.
 */
class Kint
{
    /*
    |--------------------------------------------------------------------------
    | Global Settings
    |--------------------------------------------------------------------------
    */

    /**
     * @var list<class-string<ConstructablePluginInterface>|ConstructablePluginInterface>|null
     */
    public $plugins;

    public int $maxDepth           = 6;
    public bool $displayCalledFrom = true;
    public bool $expanded          = false;

    /*
    |--------------------------------------------------------------------------
    | RichRenderer Settings
    |--------------------------------------------------------------------------
    */
    public string $richTheme = 'aante-light.css';
    public bool $richFolder  = false;

    /**
     * @var array<string, class-string<ValuePluginInterface>>|null
     */
    public $richObjectPlugins;

    /**
     * @var array<string, class-string<TabPluginInterface>>|null
     */
    public $richTabPlugins;

    /*
    |--------------------------------------------------------------------------
    | CLI Settings
    |--------------------------------------------------------------------------
    */
    public bool $cliColors      = true;
    public bool $cliForceUTF8   = false;
    public bool $cliDetectWidth = true;
    public int $cliMinWidth     = 40;
}


##########################################################
FILE PATH: app/Config/Logger.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Log\Handlers\FileHandler;
use CodeIgniter\Log\Handlers\HandlerInterface;

class Logger extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Error Logging Threshold
     * --------------------------------------------------------------------------
     *
     * You can enable error logging by setting a threshold over zero. The
     * threshold determines what gets logged. Any values below or equal to the
     * threshold will be logged.
     *
     * Threshold options are:
     *
     * - 0 = Disables logging, Error logging TURNED OFF
     * - 1 = Emergency Messages - System is unusable
     * - 2 = Alert Messages - Action Must Be Taken Immediately
     * - 3 = Critical Messages - Application component unavailable, unexpected exception.
     * - 4 = Runtime Errors - Don't need immediate action, but should be monitored.
     * - 5 = Warnings - Exceptional occurrences that are not errors.
     * - 6 = Notices - Normal but significant events.
     * - 7 = Info - Interesting events, like user logging in, etc.
     * - 8 = Debug - Detailed debug information.
     * - 9 = All Messages
     *
     * You can also pass an array with threshold levels to show individual error types
     *
     *     array(1, 2, 3, 8) = Emergency, Alert, Critical, and Debug messages
     *
     * For a live site you'll usually enable Critical or higher (3) to be logged otherwise
     * your log files will fill up very fast.
     *
     * @var int|list<int>
     */
    public $threshold = (ENVIRONMENT === 'production') ? 4 : 9;

    /**
     * --------------------------------------------------------------------------
     * Date Format for Logs
     * --------------------------------------------------------------------------
     *
     * Each item that is logged has an associated date. You can use PHP date
     * codes to set your own date formatting
     */
    public string $dateFormat = 'Y-m-d H:i:s';

    /**
     * --------------------------------------------------------------------------
     * Log Handlers
     * --------------------------------------------------------------------------
     *
     * The logging system supports multiple actions to be taken when something
     * is logged. This is done by allowing for multiple Handlers, special classes
     * designed to write the log to their chosen destinations, whether that is
     * a file on the getServer, a cloud-based service, or even taking actions such
     * as emailing the dev team.
     *
     * Each handler is defined by the class name used for that handler, and it
     * MUST implement the `CodeIgniter\Log\Handlers\HandlerInterface` interface.
     *
     * The value of each key is an array of configuration items that are sent
     * to the constructor of each handler. The only required configuration item
     * is the 'handles' element, which must be an array of integer log levels.
     * This is most easily handled by using the constants defined in the
     * `Psr\Log\LogLevel` class.
     *
     * Handlers are executed in the order defined in this array, starting with
     * the handler on top and continuing down.
     *
     * @var array<class-string<HandlerInterface>, array<string, int|list<string>|string>>
     */
    public array $handlers = [
        /*
         * --------------------------------------------------------------------
         * File Handler
         * --------------------------------------------------------------------
         */
        FileHandler::class => [
            // The log levels that this handler will handle.
            'handles' => [
                'critical',
                'alert',
                'emergency',
                'debug',
                'error',
                'info',
                'notice',
                'warning',
            ],

            /*
             * The default filename extension for log files.
             * An extension of 'php' allows for protecting the log files via basic
             * scripting, when they are to be stored under a publicly accessible directory.
             *
             * NOTE: Leaving it blank will default to 'log'.
             */
            'fileExtension' => '',

            /*
             * The file system permissions to be applied on newly created log files.
             *
             * IMPORTANT: This MUST be an integer (no quotes) and you MUST use octal
             * integer notation (i.e. 0700, 0644, etc.)
             */
            'filePermissions' => 0644,

            /*
             * Logging Directory Path
             *
             * By default, logs are written to WRITEPATH . 'logs/'
             * Specify a different destination here, if desired.
             */
            'path' => '',
        ],

        /*
         * The ChromeLoggerHandler requires the use of the Chrome web browser
         * and the ChromeLogger extension. Uncomment this block to use it.
         */
        // 'CodeIgniter\Log\Handlers\ChromeLoggerHandler' => [
        //     /*
        //      * The log levels that this handler will handle.
        //      */
        //     'handles' => ['critical', 'alert', 'emergency', 'debug',
        //                   'error', 'info', 'notice', 'warning'],
        // ],

        /*
         * The ErrorlogHandler writes the logs to PHP's native `error_log()` function.
         * Uncomment this block to use it.
         */
        // 'CodeIgniter\Log\Handlers\ErrorlogHandler' => [
        //     /* The log levels this handler can handle. */
        //     'handles' => ['critical', 'alert', 'emergency', 'debug', 'error', 'info', 'notice', 'warning'],
        //
        //     /*
        //     * The message type where the error should go. Can be 0 or 4, or use the
        //     * class constants: `ErrorlogHandler::TYPE_OS` (0) or `ErrorlogHandler::TYPE_SAPI` (4)
        //     */
        //     'messageType' => 0,
        // ],
    ];
}


##########################################################
FILE PATH: app/Config/Migrations.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Migrations extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Enable/Disable Migrations
     * --------------------------------------------------------------------------
     *
     * Migrations are enabled by default.
     *
     * You should enable migrations whenever you intend to do a schema migration
     * and disable it back when you're done.
     */
    public bool $enabled = true;

    /**
     * --------------------------------------------------------------------------
     * Migrations Table
     * --------------------------------------------------------------------------
     *
     * This is the name of the table that will store the current migrations state.
     * When migrations runs it will store in a database table which migration
     * files have already been run.
     */
    public string $table = 'migrations';

    /**
     * --------------------------------------------------------------------------
     * Timestamp Format
     * --------------------------------------------------------------------------
     *
     * This is the format that will be used when creating new migrations
     * using the CLI command:
     *   > php spark make:migration
     *
     * NOTE: if you set an unsupported format, migration runner will not find
     *       your migration files.
     *
     * Supported formats:
     * - YmdHis_
     * - Y-m-d-His_
     * - Y_m_d_His_
     */
    public string $timestampFormat = 'Y-m-d-His_';
}


##########################################################
FILE PATH: app/Config/Mimes.php
##########################################################
<?php

namespace Config;

/**
 * This file contains an array of mime types.  It is used by the
 * Upload class to help identify allowed file types.
 *
 * When more than one variation for an extension exist (like jpg, jpeg, etc)
 * the most common one should be first in the array to aid the guess*
 * methods. The same applies when more than one mime-type exists for a
 * single extension.
 *
 * When working with mime types, please make sure you have the ¬¥fileinfo¬¥
 * extension enabled to reliably detect the media types.
 */
class Mimes
{
    /**
     * Map of extensions to mime types.
     *
     * @var array<string, list<string>|string>
     */
    public static array $mimes = [
        'hqx' => [
            'application/mac-binhex40',
            'application/mac-binhex',
            'application/x-binhex40',
            'application/x-mac-binhex40',
        ],
        'cpt' => 'application/mac-compactpro',
        'csv' => [
            'text/csv',
            'text/x-comma-separated-values',
            'text/comma-separated-values',
            'application/vnd.ms-excel',
            'application/x-csv',
            'text/x-csv',
            'application/csv',
            'application/excel',
            'application/vnd.msexcel',
            'text/plain',
        ],
        'bin' => [
            'application/macbinary',
            'application/mac-binary',
            'application/octet-stream',
            'application/x-binary',
            'application/x-macbinary',
        ],
        'dms' => 'application/octet-stream',
        'lha' => 'application/octet-stream',
        'lzh' => 'application/octet-stream',
        'exe' => [
            'application/octet-stream',
            'application/vnd.microsoft.portable-executable',
            'application/x-dosexec',
            'application/x-msdownload',
        ],
        'class' => 'application/octet-stream',
        'psd'   => [
            'application/x-photoshop',
            'image/vnd.adobe.photoshop',
        ],
        'so'  => 'application/octet-stream',
        'sea' => 'application/octet-stream',
        'dll' => 'application/octet-stream',
        'oda' => 'application/oda',
        'pdf' => [
            'application/pdf',
            'application/force-download',
            'application/x-download',
        ],
        'ai' => [
            'application/pdf',
            'application/postscript',
        ],
        'eps'  => 'application/postscript',
        'ps'   => 'application/postscript',
        'smi'  => 'application/smil',
        'smil' => 'application/smil',
        'mif'  => 'application/vnd.mif',
        'xls'  => [
            'application/vnd.ms-excel',
            'application/msexcel',
            'application/x-msexcel',
            'application/x-ms-excel',
            'application/x-excel',
            'application/x-dos_ms_excel',
            'application/xls',
            'application/x-xls',
            'application/excel',
            'application/download',
            'application/vnd.ms-office',
            'application/msword',
        ],
        'ppt' => [
            'application/vnd.ms-powerpoint',
            'application/powerpoint',
            'application/vnd.ms-office',
            'application/msword',
        ],
        'pptx' => [
            'application/vnd.openxmlformats-officedocument.presentationml.presentation',
        ],
        'wbxml' => 'application/wbxml',
        'wmlc'  => 'application/wmlc',
        'dcr'   => 'application/x-director',
        'dir'   => 'application/x-director',
        'dxr'   => 'application/x-director',
        'dvi'   => 'application/x-dvi',
        'gtar'  => 'application/x-gtar',
        'gz'    => 'application/x-gzip',
        'gzip'  => 'application/x-gzip',
        'php'   => [
            'application/x-php',
            'application/x-httpd-php',
            'application/php',
            'text/php',
            'text/x-php',
            'application/x-httpd-php-source',
        ],
        'php4'  => 'application/x-httpd-php',
        'php3'  => 'application/x-httpd-php',
        'phtml' => 'application/x-httpd-php',
        'phps'  => 'application/x-httpd-php-source',
        'js'    => [
            'application/x-javascript',
            'text/plain',
        ],
        'swf' => 'application/x-shockwave-flash',
        'sit' => 'application/x-stuffit',
        'tar' => 'application/x-tar',
        'tgz' => [
            'application/x-tar',
            'application/x-gzip-compressed',
        ],
        'z'     => 'application/x-compress',
        'xhtml' => 'application/xhtml+xml',
        'xht'   => 'application/xhtml+xml',
        'zip'   => [
            'application/x-zip',
            'application/zip',
            'application/x-zip-compressed',
            'application/s-compressed',
            'multipart/x-zip',
        ],
        'rar' => [
            'application/vnd.rar',
            'application/x-rar',
            'application/rar',
            'application/x-rar-compressed',
        ],
        'mid'  => 'audio/midi',
        'midi' => 'audio/midi',
        'mpga' => 'audio/mpeg',
        'mp2'  => 'audio/mpeg',
        'mp3'  => [
            'audio/mpeg',
            'audio/mpg',
            'audio/mpeg3',
            'audio/mp3',
        ],
        'aif' => [
            'audio/x-aiff',
            'audio/aiff',
        ],
        'aiff' => [
            'audio/x-aiff',
            'audio/aiff',
        ],
        'aifc' => 'audio/x-aiff',
        'ram'  => 'audio/x-pn-realaudio',
        'rm'   => 'audio/x-pn-realaudio',
        'rpm'  => 'audio/x-pn-realaudio-plugin',
        'ra'   => 'audio/x-realaudio',
        'rv'   => 'video/vnd.rn-realvideo',
        'wav'  => [
            'audio/x-wav',
            'audio/wave',
            'audio/wav',
        ],
        'bmp' => [
            'image/bmp',
            'image/x-bmp',
            'image/x-bitmap',
            'image/x-xbitmap',
            'image/x-win-bitmap',
            'image/x-windows-bmp',
            'image/ms-bmp',
            'image/x-ms-bmp',
            'application/bmp',
            'application/x-bmp',
            'application/x-win-bitmap',
        ],
        'gif' => 'image/gif',
        'jpg' => [
            'image/jpeg',
            'image/pjpeg',
        ],
        'jpeg' => [
            'image/jpeg',
            'image/pjpeg',
        ],
        'jpe' => [
            'image/jpeg',
            'image/pjpeg',
        ],
        'jp2' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'j2k' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'jpf' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'jpg2' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'jpx' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'jpm' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'mj2' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'mjp2' => [
            'image/jp2',
            'video/mj2',
            'image/jpx',
            'image/jpm',
        ],
        'png' => [
            'image/png',
            'image/x-png',
        ],
        'webp' => 'image/webp',
        'tif'  => 'image/tiff',
        'tiff' => 'image/tiff',
        'css'  => [
            'text/css',
            'text/plain',
        ],
        'html' => [
            'text/html',
            'text/plain',
        ],
        'htm' => [
            'text/html',
            'text/plain',
        ],
        'shtml' => [
            'text/html',
            'text/plain',
        ],
        'txt'  => 'text/plain',
        'text' => 'text/plain',
        'log'  => [
            'text/plain',
            'text/x-log',
        ],
        'rtx' => 'text/richtext',
        'rtf' => 'text/rtf',
        'xml' => [
            'application/xml',
            'text/xml',
            'text/plain',
        ],
        'xsl' => [
            'application/xml',
            'text/xsl',
            'text/xml',
        ],
        'mpeg' => 'video/mpeg',
        'mpg'  => 'video/mpeg',
        'mpe'  => 'video/mpeg',
        'qt'   => 'video/quicktime',
        'mov'  => 'video/quicktime',
        'avi'  => [
            'video/x-msvideo',
            'video/msvideo',
            'video/avi',
            'application/x-troff-msvideo',
        ],
        'movie' => 'video/x-sgi-movie',
        'doc'   => [
            'application/msword',
            'application/vnd.ms-office',
        ],
        'docx' => [
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
            'application/zip',
            'application/msword',
            'application/x-zip',
        ],
        'dot' => [
            'application/msword',
            'application/vnd.ms-office',
        ],
        'dotx' => [
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
            'application/zip',
            'application/msword',
        ],
        'xlsx' => [
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
            'application/zip',
            'application/vnd.ms-excel',
            'application/msword',
            'application/x-zip',
        ],
        'xlsb' => 'application/vnd.ms-excel.sheet.binary.macroEnabled.12',
        'xlsm' => 'application/vnd.ms-excel.sheet.macroEnabled.12',
        'word' => [
            'application/msword',
            'application/octet-stream',
        ],
        'xl'   => 'application/excel',
        'eml'  => 'message/rfc822',
        'json' => [
            'application/json',
            'text/json',
        ],
        'pem' => [
            'application/x-x509-user-cert',
            'application/x-pem-file',
            'application/octet-stream',
        ],
        'p10' => [
            'application/x-pkcs10',
            'application/pkcs10',
        ],
        'p12' => 'application/x-pkcs12',
        'p7a' => 'application/x-pkcs7-signature',
        'p7c' => [
            'application/pkcs7-mime',
            'application/x-pkcs7-mime',
        ],
        'p7m' => [
            'application/pkcs7-mime',
            'application/x-pkcs7-mime',
        ],
        'p7r' => 'application/x-pkcs7-certreqresp',
        'p7s' => 'application/pkcs7-signature',
        'crt' => [
            'application/x-x509-ca-cert',
            'application/x-x509-user-cert',
            'application/pkix-cert',
        ],
        'crl' => [
            'application/pkix-crl',
            'application/pkcs-crl',
        ],
        'der' => 'application/x-x509-ca-cert',
        'kdb' => 'application/octet-stream',
        'pgp' => 'application/pgp',
        'gpg' => 'application/gpg-keys',
        'sst' => 'application/octet-stream',
        'csr' => 'application/octet-stream',
        'rsa' => 'application/x-pkcs7',
        'cer' => [
            'application/pkix-cert',
            'application/x-x509-ca-cert',
        ],
        '3g2' => 'video/3gpp2',
        '3gp' => [
            'video/3gp',
            'video/3gpp',
        ],
        'mp4' => 'video/mp4',
        'm4a' => 'audio/x-m4a',
        'f4v' => [
            'video/mp4',
            'video/x-f4v',
        ],
        'flv'  => 'video/x-flv',
        'webm' => 'video/webm',
        'aac'  => 'audio/x-acc',
        'm4u'  => 'application/vnd.mpegurl',
        'm3u'  => 'text/plain',
        'xspf' => 'application/xspf+xml',
        'vlc'  => 'application/videolan',
        'wmv'  => [
            'video/x-ms-wmv',
            'video/x-ms-asf',
        ],
        'au'   => 'audio/x-au',
        'ac3'  => 'audio/ac3',
        'flac' => 'audio/x-flac',
        'ogg'  => [
            'audio/ogg',
            'video/ogg',
            'application/ogg',
        ],
        'kmz' => [
            'application/vnd.google-earth.kmz',
            'application/zip',
            'application/x-zip',
        ],
        'kml' => [
            'application/vnd.google-earth.kml+xml',
            'application/xml',
            'text/xml',
        ],
        'ics'  => 'text/calendar',
        'ical' => 'text/calendar',
        'zsh'  => 'text/x-scriptzsh',
        '7zip' => [
            'application/x-compressed',
            'application/x-zip-compressed',
            'application/zip',
            'multipart/x-zip',
        ],
        'cdr' => [
            'application/cdr',
            'application/coreldraw',
            'application/x-cdr',
            'application/x-coreldraw',
            'image/cdr',
            'image/x-cdr',
            'zz-application/zz-winassoc-cdr',
        ],
        'wma' => [
            'audio/x-ms-wma',
            'video/x-ms-asf',
        ],
        'jar' => [
            'application/java-archive',
            'application/x-java-application',
            'application/x-jar',
            'application/x-compressed',
        ],
        'svg' => [
            'image/svg+xml',
            'image/svg',
            'application/xml',
            'text/xml',
        ],
        'vcf' => 'text/x-vcard',
        'srt' => [
            'text/srt',
            'text/plain',
        ],
        'vtt' => [
            'text/vtt',
            'text/plain',
        ],
        'ico' => [
            'image/x-icon',
            'image/x-ico',
            'image/vnd.microsoft.icon',
        ],
        'stl' => [
            'application/sla',
            'application/vnd.ms-pki.stl',
            'application/x-navistyle',
            'model/stl',
            'application/octet-stream',
        ],
    ];

    /**
     * Attempts to determine the best mime type for the given file extension.
     *
     * @return string|null The mime type found, or none if unable to determine.
     */
    public static function guessTypeFromExtension(string $extension)
    {
        $extension = trim(strtolower($extension), '. ');

        if (! array_key_exists($extension, static::$mimes)) {
            return null;
        }

        return is_array(static::$mimes[$extension]) ? static::$mimes[$extension][0] : static::$mimes[$extension];
    }

    /**
     * Attempts to determine the best file extension for a given mime type.
     *
     * @param string|null $proposedExtension - default extension (in case there is more than one with the same mime type)
     *
     * @return string|null The extension determined, or null if unable to match.
     */
    public static function guessExtensionFromType(string $type, ?string $proposedExtension = null)
    {
        $type = trim(strtolower($type), '. ');

        $proposedExtension = trim(strtolower($proposedExtension ?? ''));

        if (
            $proposedExtension !== ''
            && array_key_exists($proposedExtension, static::$mimes)
            && in_array($type, (array) static::$mimes[$proposedExtension], true)
        ) {
            // The detected mime type matches with the proposed extension.
            return $proposedExtension;
        }

        // Reverse check the mime type list if no extension was proposed.
        // This search is order sensitive!
        foreach (static::$mimes as $ext => $types) {
            if (in_array($type, (array) $types, true)) {
                return $ext;
            }
        }

        return null;
    }
}


##########################################################
FILE PATH: app/Config/Modules.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Modules\Modules as BaseModules;

/**
 * Modules Configuration.
 *
 * NOTE: This class is required prior to Autoloader instantiation,
 *       and does not extend BaseConfig.
 */
class Modules extends BaseModules
{
    /**
     * --------------------------------------------------------------------------
     * Enable Auto-Discovery?
     * --------------------------------------------------------------------------
     *
     * If true, then auto-discovery will happen across all elements listed in
     * $aliases below. If false, no auto-discovery will happen at all,
     * giving a slight performance boost.
     *
     * @var bool
     */
    public $enabled = true;

    /**
     * --------------------------------------------------------------------------
     * Enable Auto-Discovery Within Composer Packages?
     * --------------------------------------------------------------------------
     *
     * If true, then auto-discovery will happen across all namespaces loaded
     * by Composer, as well as the namespaces configured locally.
     *
     * @var bool
     */
    public $discoverInComposer = true;

    /**
     * The Composer package list for Auto-Discovery
     * This setting is optional.
     *
     * E.g.:
     *   [
     *       'only' => [
     *           // List up all packages to auto-discover
     *           'codeigniter4/shield',
     *       ],
     *   ]
     *   or
     *   [
     *       'exclude' => [
     *           // List up packages to exclude.
     *           'pestphp/pest',
     *       ],
     *   ]
     *
     * @var array{only?: list<string>, exclude?: list<string>}
     */
    public $composerPackages = [];

    /**
     * --------------------------------------------------------------------------
     * Auto-Discovery Rules
     * --------------------------------------------------------------------------
     *
     * Aliases list of all discovery classes that will be active and used during
     * the current application request.
     *
     * If it is not listed, only the base application elements will be used.
     *
     * @var list<string>
     */
    public $aliases = [
        'events',
        'filters',
        'registrars',
        'routes',
        'services',
    ];
}


##########################################################
FILE PATH: app/Config/Optimize.php
##########################################################
<?php

namespace Config;

/**
 * Optimization Configuration.
 *
 * NOTE: This class does not extend BaseConfig for performance reasons.
 *       So you cannot replace the property values with Environment Variables.
 */
class Optimize
{
    /**
     * --------------------------------------------------------------------------
     * Config Caching
     * --------------------------------------------------------------------------
     *
     * @see https://codeigniter.com/user_guide/concepts/factories.html#config-caching
     */
    public bool $configCacheEnabled = false;

    /**
     * --------------------------------------------------------------------------
     * Config Caching
     * --------------------------------------------------------------------------
     *
     * @see https://codeigniter.com/user_guide/concepts/autoloader.html#file-locator-caching
     */
    public bool $locatorCacheEnabled = false;
}


##########################################################
FILE PATH: app/Config/Pager.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Pager extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Templates
     * --------------------------------------------------------------------------
     *
     * Pagination links are rendered out using views to configure their
     * appearance. This array contains aliases and the view names to
     * use when rendering the links.
     *
     * Within each view, the Pager object will be available as $pager,
     * and the desired group as $pagerGroup;
     *
     * @var array<string, string>
     */
    public array $templates = [
        'default_full'   => 'CodeIgniter\Pager\Views\default_full',
        'default_simple' => 'CodeIgniter\Pager\Views\default_simple',
        'default_head'   => 'CodeIgniter\Pager\Views\default_head',
    ];

    /**
     * --------------------------------------------------------------------------
     * Items Per Page
     * --------------------------------------------------------------------------
     *
     * The default number of results shown in a single page.
     */
    public int $perPage = 20;
}


##########################################################
FILE PATH: app/Config/Paths.php
##########################################################
<?php

namespace Config;

/**
 * Paths
 *
 * Holds the paths that are used by the system to
 * locate the main directories, app, system, etc.
 *
 * Modifying these allows you to restructure your application,
 * share a system folder between multiple applications, and more.
 *
 * All paths are relative to the project's root folder.
 */
class Paths
{
    /**
     * ---------------------------------------------------------------
     * SYSTEM FOLDER NAME
     * ---------------------------------------------------------------
     *
     * This must contain the name of your "system" folder. Include
     * the path if the folder is not in the same directory as this file.
     */
    public string $systemDirectory = __DIR__ . '/../../vendor/codeigniter4/framework/system';

    /**
     * ---------------------------------------------------------------
     * APPLICATION FOLDER NAME
     * ---------------------------------------------------------------
     *
     * If you want this front controller to use a different "app"
     * folder than the default one you can set its name here. The folder
     * can also be renamed or relocated anywhere on your server. If
     * you do, use a full server path.
     *
     * @see http://codeigniter.com/user_guide/general/managing_apps.html
     */
    public string $appDirectory = __DIR__ . '/..';

    /**
     * ---------------------------------------------------------------
     * WRITABLE DIRECTORY NAME
     * ---------------------------------------------------------------
     *
     * This variable must contain the name of your "writable" directory.
     * The writable directory allows you to group all directories that
     * need write permission to a single place that can be tucked away
     * for maximum security, keeping it out of the app and/or
     * system directories.
     */
    public string $writableDirectory = __DIR__ . '/../../writable';

    /**
     * ---------------------------------------------------------------
     * TESTS DIRECTORY NAME
     * ---------------------------------------------------------------
     *
     * This variable must contain the name of your "tests" directory.
     */
    public string $testsDirectory = __DIR__ . '/../../tests';

    /**
     * ---------------------------------------------------------------
     * VIEW DIRECTORY NAME
     * ---------------------------------------------------------------
     *
     * This variable must contain the name of the directory that
     * contains the view files used by your application. By
     * default this is in `app/Views`. This value
     * is used when no value is provided to `Services::renderer()`.
     */
    public string $viewDirectory = __DIR__ . '/../Views';
}


##########################################################
FILE PATH: app/Config/Publisher.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\Publisher as BasePublisher;

/**
 * Publisher Configuration
 *
 * Defines basic security restrictions for the Publisher class
 * to prevent abuse by injecting malicious files into a project.
 */
class Publisher extends BasePublisher
{
    /**
     * A list of allowed destinations with a (pseudo-)regex
     * of allowed files for each destination.
     * Attempts to publish to directories not in this list will
     * result in a PublisherException. Files that do no fit the
     * pattern will cause copy/merge to fail.
     *
     * @var array<string, string>
     */
    public $restrictions = [
        ROOTPATH => '*',
        FCPATH   => '#\.(s?css|js|map|html?|xml|json|webmanifest|ttf|eot|woff2?|gif|jpe?g|tiff?|png|webp|bmp|ico|svg)$#i',
    ];
}


##########################################################
FILE PATH: app/Config/Routes.php
##########################################################
<?php

use CodeIgniter\Router\RouteCollection;

/**
 * @var RouteCollection $routes
 */

// 1. HALAMAN PUBLIK (Katalog & Detail)
// 'as' => '...' adalah Named Route
$routes->get('/', 'Home::index', ['as' => 'home']);

// Kita ganti controller 'Daily' menjadi 'Product' agar sesuai konteks
$routes->get('product/(:segment)', 'Product::index/$1', ['as' => 'product.detail']);


// 2. AUTHENTICATION
$routes->get('login', 'Auth::login', ['as' => 'login']);
$routes->post('auth/attempt_login', 'Auth::attempt_login');
$routes->get('logout', 'Auth::logout', ['as' => 'logout']);


// 3. ADMIN & PANEL (Grouping)
// Semua URL berawalan /admin akan masuk sini
$routes->group('admin', ['filter' => 'auth'], function($routes) {
    
    // Manajemen Produk
    $routes->get('create', 'Admin::create', ['as' => 'admin.product.create']);
    $routes->post('store', 'Admin::store', ['as' => 'admin.product.store']);
    
    // Edit & Delete Produk (Perhatikan 'as' yang jelas)
    $routes->get('edit-product/(:num)', 'Admin::edit_product/$1', ['as' => 'admin.product.edit']);
    $routes->post('update-product', 'Admin::update_product', ['as' => 'admin.product.update']);
    $routes->get('delete-product/(:num)', 'Admin::delete_product/$1', ['as' => 'admin.product.delete']);
    
    // Manajemen Link
    $routes->get('add-link/(:num)', 'Admin::add_link/$1', ['as' => 'admin.link.add']);
    $routes->post('store-link', 'Admin::store_link', ['as' => 'admin.link.store']);
    $routes->get('edit-link/(:num)', 'Admin::edit_link/$1', ['as' => 'admin.link.edit']);
    $routes->post('update-link', 'Admin::update_link', ['as' => 'admin.link.update']);
    $routes->get('delete-link/(:num)', 'Admin::delete_link/$1', ['as' => 'admin.link.delete']);
    
    // AI Tools
    $routes->get('regenerate/(:num)', 'Admin::generate_ai/$1', ['as' => 'admin.ai.regenerate']);
    
    // Dictionary (Label)
    $routes->get('labels', 'LabelEditor::index', ['as' => 'admin.labels']);
    $routes->post('labels/update', 'LabelEditor::update', ['as' => 'admin.labels.update']);
});

// 4. PANEL DASHBOARD
$routes->group('panel', ['filter' => 'auth'], function($routes) {
    $routes->get('/', 'Panel::index', ['as' => 'panel.dashboard']);
    $routes->get('nuke', 'Panel::nuke_db', ['as' => 'panel.nuke']);
    $routes->get('toggle-ai', 'Panel::toggle_ai', ['as' => 'panel.toggle_ai']);
    $routes->post('change-password', 'Panel::change_password', ['as' => 'panel.password']);
    $routes->get('generate-sitemap', 'Panel::generate_sitemap', ['as' => 'panel.sitemap']);
    $routes->post('update-settings', 'Panel::update_settings', ['as' => 'panel.settings']);
});

// 5. LEGACY SUPPORT (Redirect slug lama ke route baru jika perlu)
// Route catch-all ditaruh paling bawah untuk menangkap slug produk langsung (domain.com/iphone-15)
// Kita arahkan ke Product::index
$routes->get('(:segment)', 'Product::index/$1');


##########################################################
FILE PATH: app/Config/Routing.php
##########################################################
<?php

/**
 * This file is part of CodeIgniter 4 framework.
 *
 * (c) CodeIgniter Foundation <admin@codeigniter.com>
 *
 * For the full copyright and license information, please view
 * the LICENSE file that was distributed with this source code.
 */

namespace Config;

use CodeIgniter\Config\Routing as BaseRouting;

/**
 * Routing configuration
 */
class Routing extends BaseRouting
{
    /**
     * For Defined Routes.
     * An array of files that contain route definitions.
     * Route files are read in order, with the first match
     * found taking precedence.
     *
     * Default: APPPATH . 'Config/Routes.php'
     *
     * @var list<string>
     */
    public array $routeFiles = [
        APPPATH . 'Config/Routes.php',
    ];

    /**
     * For Defined Routes and Auto Routing.
     * The default namespace to use for Controllers when no other
     * namespace has been specified.
     *
     * Default: 'App\Controllers'
     */
    public string $defaultNamespace = 'App\Controllers';

    /**
     * For Auto Routing.
     * The default controller to use when no other controller has been
     * specified.
     *
     * Default: 'Home'
     */
    public string $defaultController = 'Home';

    /**
     * For Defined Routes and Auto Routing.
     * The default method to call on the controller when no other
     * method has been set in the route.
     *
     * Default: 'index'
     */
    public string $defaultMethod = 'index';

    /**
     * For Auto Routing.
     * Whether to translate dashes in URIs for controller/method to underscores.
     * Primarily useful when using the auto-routing.
     *
     * Default: false
     */
    public bool $translateURIDashes = false;

    /**
     * Sets the class/method that should be called if routing doesn't
     * find a match. It can be the controller/method name like: Users::index
     *
     * This setting is passed to the Router class and handled there.
     *
     * If you want to use a closure, you will have to set it in the
     * routes file by calling:
     *
     * $routes->set404Override(function() {
     *    // Do something here
     * });
     *
     * Example:
     *  public $override404 = 'App\Errors::show404';
     */
    public ?string $override404 = null;

    /**
     * If TRUE, the system will attempt to match the URI against
     * Controllers by matching each segment against folders/files
     * in APPPATH/Controllers, when a match wasn't found against
     * defined routes.
     *
     * If FALSE, will stop searching and do NO automatic routing.
     */
    public bool $autoRoute = false;

    /**
     * For Defined Routes.
     * If TRUE, will enable the use of the 'prioritize' option
     * when defining routes.
     *
     * Default: false
     */
    public bool $prioritize = false;

    /**
     * For Defined Routes.
     * If TRUE, matched multiple URI segments will be passed as one parameter.
     *
     * Default: false
     */
    public bool $multipleSegmentsOneParam = false;

    /**
     * For Auto Routing (Improved).
     * Map of URI segments and namespaces.
     *
     * The key is the first URI segment. The value is the controller namespace.
     * E.g.,
     *   [
     *       'blog' => 'Acme\Blog\Controllers',
     *   ]
     *
     * @var array<string, string>
     */
    public array $moduleRoutes = [];

    /**
     * For Auto Routing (Improved).
     * Whether to translate dashes in URIs for controller/method to CamelCase.
     * E.g., blog-controller -> BlogController
     *
     * If you enable this, $translateURIDashes is ignored.
     *
     * Default: false
     */
    public bool $translateUriToCamelCase = true;
}


##########################################################
FILE PATH: app/Config/Security.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

class Security extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * CSRF Protection Method
     * --------------------------------------------------------------------------
     *
     * Protection Method for Cross Site Request Forgery protection.
     *
     * @var string 'cookie' or 'session'
     */
    public string $csrfProtection = 'cookie';

    /**
     * --------------------------------------------------------------------------
     * CSRF Token Randomization
     * --------------------------------------------------------------------------
     *
     * Randomize the CSRF Token for added security.
     */
    public bool $tokenRandomize = false;

    /**
     * --------------------------------------------------------------------------
     * CSRF Token Name
     * --------------------------------------------------------------------------
     *
     * Token name for Cross Site Request Forgery protection.
     */
    public string $tokenName = 'csrf_test_name';

    /**
     * --------------------------------------------------------------------------
     * CSRF Header Name
     * --------------------------------------------------------------------------
     *
     * Header name for Cross Site Request Forgery protection.
     */
    public string $headerName = 'X-CSRF-TOKEN';

    /**
     * --------------------------------------------------------------------------
     * CSRF Cookie Name
     * --------------------------------------------------------------------------
     *
     * Cookie name for Cross Site Request Forgery protection.
     */
    public string $cookieName = 'csrf_cookie_name';

    /**
     * --------------------------------------------------------------------------
     * CSRF Expires
     * --------------------------------------------------------------------------
     *
     * Expiration time for Cross Site Request Forgery protection cookie.
     *
     * Defaults to two hours (in seconds).
     */
    public int $expires = 7200;

    /**
     * --------------------------------------------------------------------------
     * CSRF Regenerate
     * --------------------------------------------------------------------------
     *
     * Regenerate CSRF Token on every submission.
     */
    public bool $regenerate = false;

    /**
     * --------------------------------------------------------------------------
     * CSRF Redirect
     * --------------------------------------------------------------------------
     *
     * Redirect to previous page with error on failure.
     *
     * @see https://codeigniter4.github.io/userguide/libraries/security.html#redirection-on-failure
     */
    public bool $redirect = (ENVIRONMENT === 'production');
}


##########################################################
FILE PATH: app/Config/Services.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseService;

/**
 * Services Configuration file.
 *
 * Services are simply other classes/libraries that the system uses
 * to do its job. This is used by CodeIgniter to allow the core of the
 * framework to be swapped out easily without affecting the usage within
 * the rest of your application.
 *
 * This file holds any application-specific services, or service overrides
 * that you might need. An example has been included with the general
 * method format you should use for your service methods. For more examples,
 * see the core Services file at system/Config/Services.php.
 */
class Services extends BaseService
{
    /*
     * public static function example($getShared = true)
     * {
     *     if ($getShared) {
     *         return static::getSharedInstance('example');
     *     }
     *
     *     return new \CodeIgniter\Example();
     * }
     */
}


##########################################################
FILE PATH: app/Config/Session.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Session\Handlers\BaseHandler;
use CodeIgniter\Session\Handlers\FileHandler;

class Session extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Session Driver
     * --------------------------------------------------------------------------
     *
     * The session storage driver to use:
     * - `CodeIgniter\Session\Handlers\FileHandler`
     * - `CodeIgniter\Session\Handlers\DatabaseHandler`
     * - `CodeIgniter\Session\Handlers\MemcachedHandler`
     * - `CodeIgniter\Session\Handlers\RedisHandler`
     *
     * @var class-string<BaseHandler>
     */
    public string $driver = FileHandler::class;

    /**
     * --------------------------------------------------------------------------
     * Session Cookie Name
     * --------------------------------------------------------------------------
     *
     * The session cookie name, must contain only [0-9a-z_-] characters
     */
    public string $cookieName = 'ci_session';

    /**
     * --------------------------------------------------------------------------
     * Session Expiration
     * --------------------------------------------------------------------------
     *
     * The number of SECONDS you want the session to last.
     * Setting to 0 (zero) means expire when the browser is closed.
     */
    public int $expiration = 7200;

    /**
     * --------------------------------------------------------------------------
     * Session Save Path
     * --------------------------------------------------------------------------
     *
     * The location to save sessions to and is driver dependent.
     *
     * For the 'files' driver, it's a path to a writable directory.
     * WARNING: Only absolute paths are supported!
     *
     * For the 'database' driver, it's a table name.
     * Please read up the manual for the format with other session drivers.
     *
     * IMPORTANT: You are REQUIRED to set a valid save path!
     */
    public string $savePath = WRITEPATH . 'session';

    /**
     * --------------------------------------------------------------------------
     * Session Match IP
     * --------------------------------------------------------------------------
     *
     * Whether to match the user's IP address when reading the session data.
     *
     * WARNING: If you're using the database driver, don't forget to update
     *          your session table's PRIMARY KEY when changing this setting.
     */
    public bool $matchIP = false;

    /**
     * --------------------------------------------------------------------------
     * Session Time to Update
     * --------------------------------------------------------------------------
     *
     * How many seconds between CI regenerating the session ID.
     */
    public int $timeToUpdate = 300;

    /**
     * --------------------------------------------------------------------------
     * Session Regenerate Destroy
     * --------------------------------------------------------------------------
     *
     * Whether to destroy session data associated with the old session ID
     * when auto-regenerating the session ID. When set to FALSE, the data
     * will be later deleted by the garbage collector.
     */
    public bool $regenerateDestroy = false;

    /**
     * --------------------------------------------------------------------------
     * Session Database Group
     * --------------------------------------------------------------------------
     *
     * DB Group for the database session.
     */
    public ?string $DBGroup = null;

    /**
     * --------------------------------------------------------------------------
     * Lock Retry Interval (microseconds)
     * --------------------------------------------------------------------------
     *
     * This is used for RedisHandler.
     *
     * Time (microseconds) to wait if lock cannot be acquired.
     * The default is 100,000 microseconds (= 0.1 seconds).
     */
    public int $lockRetryInterval = 100_000;

    /**
     * --------------------------------------------------------------------------
     * Lock Max Retries
     * --------------------------------------------------------------------------
     *
     * This is used for RedisHandler.
     *
     * Maximum number of lock acquisition attempts.
     * The default is 300 times. That is lock timeout is about 30 (0.1 * 300)
     * seconds.
     */
    public int $lockMaxRetries = 300;
}


##########################################################
FILE PATH: app/Config/Toolbar.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Debug\Toolbar\Collectors\Database;
use CodeIgniter\Debug\Toolbar\Collectors\Events;
use CodeIgniter\Debug\Toolbar\Collectors\Files;
use CodeIgniter\Debug\Toolbar\Collectors\Logs;
use CodeIgniter\Debug\Toolbar\Collectors\Routes;
use CodeIgniter\Debug\Toolbar\Collectors\Timers;
use CodeIgniter\Debug\Toolbar\Collectors\Views;

/**
 * --------------------------------------------------------------------------
 * Debug Toolbar
 * --------------------------------------------------------------------------
 *
 * The Debug Toolbar provides a way to see information about the performance
 * and state of your application during that page display. By default it will
 * NOT be displayed under production environments, and will only display if
 * `CI_DEBUG` is true, since if it's not, there's not much to display anyway.
 */
class Toolbar extends BaseConfig
{
    /**
     * --------------------------------------------------------------------------
     * Toolbar Collectors
     * --------------------------------------------------------------------------
     *
     * List of toolbar collectors that will be called when Debug Toolbar
     * fires up and collects data from.
     *
     * @var list<class-string>
     */
    public array $collectors = [
        Timers::class,
        Database::class,
        Logs::class,
        Views::class,
        // \CodeIgniter\Debug\Toolbar\Collectors\Cache::class,
        Files::class,
        Routes::class,
        Events::class,
    ];

    /**
     * --------------------------------------------------------------------------
     * Collect Var Data
     * --------------------------------------------------------------------------
     *
     * If set to false var data from the views will not be collected. Useful to
     * avoid high memory usage when there are lots of data passed to the view.
     */
    public bool $collectVarData = true;

    /**
     * --------------------------------------------------------------------------
     * Max History
     * --------------------------------------------------------------------------
     *
     * `$maxHistory` sets a limit on the number of past requests that are stored,
     * helping to conserve file space used to store them. You can set it to
     * 0 (zero) to not have any history stored, or -1 for unlimited history.
     */
    public int $maxHistory = 20;

    /**
     * --------------------------------------------------------------------------
     * Toolbar Views Path
     * --------------------------------------------------------------------------
     *
     * The full path to the the views that are used by the toolbar.
     * This MUST have a trailing slash.
     */
    public string $viewsPath = SYSTEMPATH . 'Debug/Toolbar/Views/';

    /**
     * --------------------------------------------------------------------------
     * Max Queries
     * --------------------------------------------------------------------------
     *
     * If the Database Collector is enabled, it will log every query that the
     * the system generates so they can be displayed on the toolbar's timeline
     * and in the query log. This can lead to memory issues in some instances
     * with hundreds of queries.
     *
     * `$maxQueries` defines the maximum amount of queries that will be stored.
     */
    public int $maxQueries = 100;

    /**
     * --------------------------------------------------------------------------
     * Watched Directories
     * --------------------------------------------------------------------------
     *
     * Contains an array of directories that will be watched for changes and
     * used to determine if the hot-reload feature should reload the page or not.
     * We restrict the values to keep performance as high as possible.
     *
     * NOTE: The ROOTPATH will be prepended to all values.
     *
     * @var list<string>
     */
    public array $watchedDirectories = [
        'app',
    ];

    /**
     * --------------------------------------------------------------------------
     * Watched File Extensions
     * --------------------------------------------------------------------------
     *
     * Contains an array of file extensions that will be watched for changes and
     * used to determine if the hot-reload feature should reload the page or not.
     *
     * @var list<string>
     */
    public array $watchedExtensions = [
        'php', 'css', 'js', 'html', 'svg', 'json', 'env',
    ];
}


##########################################################
FILE PATH: app/Config/UserAgents.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;

/**
 * -------------------------------------------------------------------
 * User Agents
 * -------------------------------------------------------------------
 *
 * This file contains four arrays of user agent data. It is used by the
 * User Agent Class to help identify browser, platform, robot, and
 * mobile device data. The array keys are used to identify the device
 * and the array values are used to set the actual name of the item.
 */
class UserAgents extends BaseConfig
{
    /**
     * -------------------------------------------------------------------
     * OS Platforms
     * -------------------------------------------------------------------
     *
     * @var array<string, string>
     */
    public array $platforms = [
        'windows nt 10.0' => 'Windows 10',
        'windows nt 6.3'  => 'Windows 8.1',
        'windows nt 6.2'  => 'Windows 8',
        'windows nt 6.1'  => 'Windows 7',
        'windows nt 6.0'  => 'Windows Vista',
        'windows nt 5.2'  => 'Windows 2003',
        'windows nt 5.1'  => 'Windows XP',
        'windows nt 5.0'  => 'Windows 2000',
        'windows nt 4.0'  => 'Windows NT 4.0',
        'winnt4.0'        => 'Windows NT 4.0',
        'winnt 4.0'       => 'Windows NT',
        'winnt'           => 'Windows NT',
        'windows 98'      => 'Windows 98',
        'win98'           => 'Windows 98',
        'windows 95'      => 'Windows 95',
        'win95'           => 'Windows 95',
        'windows phone'   => 'Windows Phone',
        'windows'         => 'Unknown Windows OS',
        'android'         => 'Android',
        'blackberry'      => 'BlackBerry',
        'iphone'          => 'iOS',
        'ipad'            => 'iOS',
        'ipod'            => 'iOS',
        'os x'            => 'Mac OS X',
        'ppc mac'         => 'Power PC Mac',
        'freebsd'         => 'FreeBSD',
        'ppc'             => 'Macintosh',
        'linux'           => 'Linux',
        'debian'          => 'Debian',
        'sunos'           => 'Sun Solaris',
        'beos'            => 'BeOS',
        'apachebench'     => 'ApacheBench',
        'aix'             => 'AIX',
        'irix'            => 'Irix',
        'osf'             => 'DEC OSF',
        'hp-ux'           => 'HP-UX',
        'netbsd'          => 'NetBSD',
        'bsdi'            => 'BSDi',
        'openbsd'         => 'OpenBSD',
        'gnu'             => 'GNU/Linux',
        'unix'            => 'Unknown Unix OS',
        'symbian'         => 'Symbian OS',
    ];

    /**
     * -------------------------------------------------------------------
     * Browsers
     * -------------------------------------------------------------------
     *
     * The order of this array should NOT be changed. Many browsers return
     * multiple browser types so we want to identify the subtype first.
     *
     * @var array<string, string>
     */
    public array $browsers = [
        'OPR'    => 'Opera',
        'Flock'  => 'Flock',
        'Edge'   => 'Spartan',
        'Edg'    => 'Edge',
        'Chrome' => 'Chrome',
        // Opera 10+ always reports Opera/9.80 and appends Version/<real version> to the user agent string
        'Opera.*?Version'   => 'Opera',
        'Opera'             => 'Opera',
        'MSIE'              => 'Internet Explorer',
        'Internet Explorer' => 'Internet Explorer',
        'Trident.* rv'      => 'Internet Explorer',
        'Shiira'            => 'Shiira',
        'Firefox'           => 'Firefox',
        'Chimera'           => 'Chimera',
        'Phoenix'           => 'Phoenix',
        'Firebird'          => 'Firebird',
        'Camino'            => 'Camino',
        'Netscape'          => 'Netscape',
        'OmniWeb'           => 'OmniWeb',
        'Safari'            => 'Safari',
        'Mozilla'           => 'Mozilla',
        'Konqueror'         => 'Konqueror',
        'icab'              => 'iCab',
        'Lynx'              => 'Lynx',
        'Links'             => 'Links',
        'hotjava'           => 'HotJava',
        'amaya'             => 'Amaya',
        'IBrowse'           => 'IBrowse',
        'Maxthon'           => 'Maxthon',
        'Ubuntu'            => 'Ubuntu Web Browser',
        'Vivaldi'           => 'Vivaldi',
    ];

    /**
     * -------------------------------------------------------------------
     * Mobiles
     * -------------------------------------------------------------------
     *
     * @var array<string, string>
     */
    public array $mobiles = [
        // legacy array, old values commented out
        'mobileexplorer' => 'Mobile Explorer',
        // 'openwave'             => 'Open Wave',
        // 'opera mini'           => 'Opera Mini',
        // 'operamini'            => 'Opera Mini',
        // 'elaine'               => 'Palm',
        'palmsource' => 'Palm',
        // 'digital paths'        => 'Palm',
        // 'avantgo'              => 'Avantgo',
        // 'xiino'                => 'Xiino',
        'palmscape' => 'Palmscape',
        // 'nokia'                => 'Nokia',
        // 'ericsson'             => 'Ericsson',
        // 'blackberry'           => 'BlackBerry',
        // 'motorola'             => 'Motorola'

        // Phones and Manufacturers
        'motorola'             => 'Motorola',
        'nokia'                => 'Nokia',
        'palm'                 => 'Palm',
        'iphone'               => 'Apple iPhone',
        'ipad'                 => 'iPad',
        'ipod'                 => 'Apple iPod Touch',
        'sony'                 => 'Sony Ericsson',
        'ericsson'             => 'Sony Ericsson',
        'blackberry'           => 'BlackBerry',
        'cocoon'               => 'O2 Cocoon',
        'blazer'               => 'Treo',
        'lg'                   => 'LG',
        'amoi'                 => 'Amoi',
        'xda'                  => 'XDA',
        'mda'                  => 'MDA',
        'vario'                => 'Vario',
        'htc'                  => 'HTC',
        'samsung'              => 'Samsung',
        'sharp'                => 'Sharp',
        'sie-'                 => 'Siemens',
        'alcatel'              => 'Alcatel',
        'benq'                 => 'BenQ',
        'ipaq'                 => 'HP iPaq',
        'mot-'                 => 'Motorola',
        'playstation portable' => 'PlayStation Portable',
        'playstation 3'        => 'PlayStation 3',
        'playstation vita'     => 'PlayStation Vita',
        'hiptop'               => 'Danger Hiptop',
        'nec-'                 => 'NEC',
        'panasonic'            => 'Panasonic',
        'philips'              => 'Philips',
        'sagem'                => 'Sagem',
        'sanyo'                => 'Sanyo',
        'spv'                  => 'SPV',
        'zte'                  => 'ZTE',
        'sendo'                => 'Sendo',
        'nintendo dsi'         => 'Nintendo DSi',
        'nintendo ds'          => 'Nintendo DS',
        'nintendo 3ds'         => 'Nintendo 3DS',
        'wii'                  => 'Nintendo Wii',
        'open web'             => 'Open Web',
        'openweb'              => 'OpenWeb',

        // Operating Systems
        'android'    => 'Android',
        'symbian'    => 'Symbian',
        'SymbianOS'  => 'SymbianOS',
        'elaine'     => 'Palm',
        'series60'   => 'Symbian S60',
        'windows ce' => 'Windows CE',

        // Browsers
        'obigo'         => 'Obigo',
        'netfront'      => 'Netfront Browser',
        'openwave'      => 'Openwave Browser',
        'mobilexplorer' => 'Mobile Explorer',
        'operamini'     => 'Opera Mini',
        'opera mini'    => 'Opera Mini',
        'opera mobi'    => 'Opera Mobile',
        'fennec'        => 'Firefox Mobile',

        // Other
        'digital paths' => 'Digital Paths',
        'avantgo'       => 'AvantGo',
        'xiino'         => 'Xiino',
        'novarra'       => 'Novarra Transcoder',
        'vodafone'      => 'Vodafone',
        'docomo'        => 'NTT DoCoMo',
        'o2'            => 'O2',

        // Fallback
        'mobile'     => 'Generic Mobile',
        'wireless'   => 'Generic Mobile',
        'j2me'       => 'Generic Mobile',
        'midp'       => 'Generic Mobile',
        'cldc'       => 'Generic Mobile',
        'up.link'    => 'Generic Mobile',
        'up.browser' => 'Generic Mobile',
        'smartphone' => 'Generic Mobile',
        'cellphone'  => 'Generic Mobile',
    ];

    /**
     * -------------------------------------------------------------------
     * Robots
     * -------------------------------------------------------------------
     *
     * There are hundred of bots but these are the most common.
     *
     * @var array<string, string>
     */
    public array $robots = [
        'googlebot'            => 'Googlebot',
        'msnbot'               => 'MSNBot',
        'baiduspider'          => 'Baiduspider',
        'bingbot'              => 'Bing',
        'slurp'                => 'Inktomi Slurp',
        'yahoo'                => 'Yahoo',
        'ask jeeves'           => 'Ask Jeeves',
        'fastcrawler'          => 'FastCrawler',
        'infoseek'             => 'InfoSeek Robot 1.0',
        'lycos'                => 'Lycos',
        'yandex'               => 'YandexBot',
        'mediapartners-google' => 'MediaPartners Google',
        'CRAZYWEBCRAWLER'      => 'Crazy Webcrawler',
        'adsbot-google'        => 'AdsBot Google',
        'feedfetcher-google'   => 'Feedfetcher Google',
        'curious george'       => 'Curious George',
        'ia_archiver'          => 'Alexa Crawler',
        'MJ12bot'              => 'Majestic-12',
        'Uptimebot'            => 'Uptimebot',
    ];
}


##########################################################
FILE PATH: app/Config/Validation.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\BaseConfig;
use CodeIgniter\Validation\StrictRules\CreditCardRules;
use CodeIgniter\Validation\StrictRules\FileRules;
use CodeIgniter\Validation\StrictRules\FormatRules;
use CodeIgniter\Validation\StrictRules\Rules;

class Validation extends BaseConfig
{
    // --------------------------------------------------------------------
    // Setup
    // --------------------------------------------------------------------

    /**
     * Stores the classes that contain the
     * rules that are available.
     *
     * @var list<string>
     */
    public array $ruleSets = [
        Rules::class,
        FormatRules::class,
        FileRules::class,
        CreditCardRules::class,
    ];

    /**
     * Specifies the views that are used to display the
     * errors.
     *
     * @var array<string, string>
     */
    public array $templates = [
        'list'   => 'CodeIgniter\Validation\Views\list',
        'single' => 'CodeIgniter\Validation\Views\single',
    ];

    // --------------------------------------------------------------------
    // Rules
    // --------------------------------------------------------------------
}


##########################################################
FILE PATH: app/Config/View.php
##########################################################
<?php

namespace Config;

use CodeIgniter\Config\View as BaseView;
use CodeIgniter\View\ViewDecoratorInterface;

/**
 * @phpstan-type parser_callable (callable(mixed): mixed)
 * @phpstan-type parser_callable_string (callable(mixed): mixed)&string
 */
class View extends BaseView
{
    /**
     * When false, the view method will clear the data between each
     * call. This keeps your data safe and ensures there is no accidental
     * leaking between calls, so you would need to explicitly pass the data
     * to each view. You might prefer to have the data stick around between
     * calls so that it is available to all views. If that is the case,
     * set $saveData to true.
     *
     * @var bool
     */
    public $saveData = true;

    /**
     * Parser Filters map a filter name with any PHP callable. When the
     * Parser prepares a variable for display, it will chain it
     * through the filters in the order defined, inserting any parameters.
     * To prevent potential abuse, all filters MUST be defined here
     * in order for them to be available for use within the Parser.
     *
     * Examples:
     *  { title|esc(js) }
     *  { created_on|date(Y-m-d)|esc(attr) }
     *
     * @var         array<string, string>
     * @phpstan-var array<string, parser_callable_string>
     */
    public $filters = [];

    /**
     * Parser Plugins provide a way to extend the functionality provided
     * by the core Parser by creating aliases that will be replaced with
     * any callable. Can be single or tag pair.
     *
     * @var         array<string, callable|list<string>|string>
     * @phpstan-var array<string, list<parser_callable_string>|parser_callable_string|parser_callable>
     */
    public $plugins = [];

    /**
     * View Decorators are class methods that will be run in sequence to
     * have a chance to alter the generated output just prior to caching
     * the results.
     *
     * All classes must implement CodeIgniter\View\ViewDecoratorInterface
     *
     * @var list<class-string<ViewDecoratorInterface>>
     */
    public array $decorators = [];
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_01_000001_DevDaily.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;
class DevDaily extends Migration {
    public function up() {
        // Tabel Produk Utama
        $this->forge->addField([
            'id' => ['type'=>'INTEGER','constraint'=>11,'unsigned'=>true,'auto_increment'=>true],
            'slug' => ['type'=>'VARCHAR','constraint'=>255,'unique'=>true],
            'name' => ['type'=>'VARCHAR','constraint'=>255],
            'market_price' => ['type'=>'INTEGER','default'=>0],
        ]);
        $this->forge->addKey('id', true);
        $this->forge->createTable('products');

        // Tabel Link Arbitrase
        $this->forge->addField([
            'id' => ['type'=>'INTEGER','constraint'=>11,'unsigned'=>true,'auto_increment'=>true],
            'product_id' => ['type'=>'INTEGER','unsigned'=>true],
            'marketplace' => ['type'=>'VARCHAR','constraint'=>50],
            'store' => ['type'=>'VARCHAR','constraint'=>100],
            'price' => ['type'=>'INTEGER','default'=>0],
            'link' => ['type'=>'TEXT'],
        ]);
        $this->forge->addKey('id', true);
        $this->forge->addForeignKey('product_id','products','id','CASCADE','CASCADE');
        $this->forge->createTable('links');
    }
    public function down() {
        $this->forge->dropTable('links');
        $this->forge->dropTable('products');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_02_000001_AddAiColumn.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class AddAiColumn extends Migration {
    public function up() {
        $this->forge->addColumn('links', [
            'ai_comment' => [
                'type' => 'TEXT',
                'null' => true,
                'after' => 'link'
            ]
        ]);
    }
    public function down() {
        $this->forge->dropColumn('links', 'ai_comment');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_03_000001_AddImage.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class AddImage extends Migration {
    public function up() {
        // Cek dulu biar gak error kalau dijalankan ulang
        if (!$this->db->fieldExists('image_url', 'products')) {
            $this->forge->addColumn('products', [
                'image_url' => [
                    'type' => 'TEXT',
                    'null' => true,
                    'default' => 'https://placehold.co/600x400/1e293b/FFF?text=NO+IMAGE' // Placeholder default
                ]
            ]);
        }
    }
    public function down() {
        $this->forge->dropColumn('products', 'image_url');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_04_000001_AddUsers.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class AddUsers extends Migration {
    public function up() {
        $this->forge->addField([
            'id' => ['type'=>'INTEGER','constraint'=>11,'unsigned'=>true,'auto_increment'=>true],
            'username' => ['type'=>'VARCHAR','constraint'=>100,'unique'=>true],
            'password' => ['type'=>'VARCHAR','constraint'=>255], // Untuk Hash
            'last_login' => ['type'=>'DATETIME','null'=>true],
        ]);
        $this->forge->addKey('id', true);
        $this->forge->createTable('users');
    }
    public function down() {
        $this->forge->dropTable('users');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_05_000001_UpgradeV18.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class UpgradeV18 extends Migration {
    public function up() {
        // A. TABEL SETTINGS (Saklar AI)
        $this->forge->addField([
            'key' => ['type'=>'VARCHAR','constraint'=>50,'unique'=>true],
            'value' => ['type'=>'VARCHAR','constraint'=>255],
        ]);
        $this->forge->addKey('key', true);
        $this->forge->createTable('settings', true);

        // B. UPDATE TABEL LINKS (Data Reputasi)
        $fields = [
            'seller_badge' => ['type'=>'VARCHAR','constraint'=>50,'default'=>'Toko Biasa'],
            'rating_score' => ['type'=>'VARCHAR','constraint'=>10,'default'=>'-'],
            'sold_count'   => ['type'=>'VARCHAR','constraint'=>50,'default'=>'-']
        ];
        $this->forge->addColumn('links', $fields);
    }

    public function down() {
        $this->forge->dropTable('settings');
        $this->forge->dropColumn('links', ['seller_badge', 'rating_score', 'sold_count']);
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_06_000001_AddBadgesToProducts.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class AddBadgesToProducts extends Migration {
    public function up() {
        // Kolom untuk menyimpan array badge (JSON)
        $this->forge->addColumn('products', [
            'badges' => [
                'type' => 'TEXT',
                'null' => true,
                'default' => '["Pilihan Ibu"]' // Default badge
            ]
        ]);
    }
    public function down() {
        $this->forge->dropColumn('products', 'badges');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_07_000001_AddDescription.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class AddDescription extends Migration {
    public function up() {
        $this->forge->addColumn('products', [
            'description' => [
                'type' => 'TEXT',
                'null' => true,
                'default' => 'Belum ada deskripsi produk.'
            ]
        ]);
    }
    public function down() {
        $this->forge->dropColumn('products', 'description');
    }
}


##########################################################
FILE PATH: app/Database/Migrations/2024_01_08_000001_SiteLabels.php
##########################################################
<?php namespace App\Database\Migrations;
use CodeIgniter\Database\Migration;

class SiteLabels extends Migration {
    public function up() {
        $this->forge->addField([
            'id' => ['type'=>'INT','constraint'=>11,'unsigned'=>true,'auto_increment'=>true],
            'group' => ['type'=>'VARCHAR','constraint'=>50], 
            'key' => ['type'=>'VARCHAR','constraint'=>100], 
            'value' => ['type'=>'TEXT'], 
            'description' => ['type'=>'VARCHAR','constraint'=>255]
        ]);
        $this->forge->addKey('id', true);
        $this->forge->createTable('site_labels');
    }
    public function down() { $this->forge->dropTable('site_labels'); }
}
